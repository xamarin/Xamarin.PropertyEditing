<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
					xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
					xmlns:local="clr-namespace:Xamarin.PropertyEditing.Windows"
					xmlns:drawing="clr-namespace:Xamarin.PropertyEditing.Drawing;assembly=Xamarin.PropertyEditing"
					xmlns:theme="clr-namespace:Microsoft.Windows.Themes;assembly=PresentationFramework.Aero"
					xmlns:prop="clr-namespace:Xamarin.PropertyEditing.Properties;assembly=Xamarin.PropertyEditing"
					xmlns:system="clr-namespace:System;assembly=mscorlib">

    <ResourceDictionary.MergedDictionaries>
        <ResourceDictionary Source="MenuButtonStyle.xaml" />
        <ResourceDictionary Source="PropertyEditorPanelStyle.xaml" />
    </ResourceDictionary.MergedDictionaries>

	<Color x:Key="DropShadowBackgroundColor">#72000000</Color>
	<SolidColorBrush x:Key="LiteralMarkerBrush">#55000000</SolidColorBrush>
	<SolidColorBrush x:Key="ResourceMarkerBrush">#FF8BD44A</SolidColorBrush>

	<Style x:Key="GenericVisualFocusStyle" TargetType="Control">
		<Setter Property="Margin" Value="1" />
		<Setter Property="Foreground" Value="{DynamicResource FocusVisualBorderBrush}" />
		<Setter Property="Template">
			<Setter.Value>
				<ControlTemplate TargetType="Control">
					<Rectangle Margin="{TemplateBinding Margin}" SnapsToDevicePixels="True" Stroke="{TemplateBinding Foreground}" StrokeThickness="1" StrokeDashArray="1 2"/>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>

	<SolidColorBrush x:Key="BrushBoxCheckerBoardLight">#FFFFFF</SolidColorBrush>
	<SolidColorBrush x:Key="BrushBoxCheckerBoardDark">#D3D3D3</SolidColorBrush>

	<DrawingBrush x:Key="CheckerBoard" Stretch="None" TileMode="Tile" Viewport="0,0,20,20" ViewportUnits="Absolute">
		<DrawingBrush.Drawing>
			<DrawingGroup>
				<GeometryDrawing Geometry="M0,0 L20,0 20,20, 0,20Z" Brush="{DynamicResource BrushBoxCheckerBoardLight}"/>
				<GeometryDrawing Geometry="M0,10 L20,10 20,20, 10,20 10,0 0,0Z" Brush="{DynamicResource BrushBoxCheckerBoardDark}"/>
			</DrawingGroup>
		</DrawingBrush.Drawing>
	</DrawingBrush>

	<local:BoolsToVisibilityConverter x:Key="BoolsToVisibilityConverter" />
	<local:CommonBrushToBrushConverter x:Key="BrushConverter" />
	<local:CommonColorToColorConverter x:Key="ColorConverter" />
	<local:GroupedEditorPropertySelector x:Key="GroupedEditorSelector" />

	<Style TargetType="local:CombinablePredefinedValuesEditor">
		<Setter Property="Template">
			<Setter.Value>
				<ControlTemplate TargetType="local:CombinablePredefinedValuesEditor">
					<ItemsControl Focusable="{TemplateBinding Focusable}" ItemsSource="{Binding Choices,Mode=OneTime}">
						<ItemsControl.ItemTemplate>
							<DataTemplate>
								<CheckBox Foreground="{DynamicResource ListItemForegroundBrush}" FocusVisualStyle="{StaticResource GenericVisualFocusStyle}" IsChecked="{Binding IsFlagged,Mode=TwoWay}" Margin="0,1,0,1" Content="{Binding Name,Mode=OneTime}" />
							</DataTemplate>
						</ItemsControl.ItemTemplate>
					</ItemsControl>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>

	<Style TargetType="{x:Type local:EnumEditorControl}">
		<Setter Property="Template">
			<Setter.Value>
				<ControlTemplate TargetType="{x:Type local:EnumEditorControl}">
					<ComboBox x:Name="ComboBox" ItemsSource="{Binding PossibleValues,Mode=OneTime}" SelectedItem="{Binding ValueName}" IsEditable="{Binding IsConstrainedToPredefined,Mode=OneTime,Converter={StaticResource OppositeBoolConverter}}" VerticalContentAlignment="Center" AutomationProperties.Name="{Binding Property.Name,Mode=OneTime}" />
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>

	<DataTemplate x:Key="GroupedPropertyValuePreview">
		<DataTemplate.Resources>
			<DataTemplate DataType="{x:Type drawing:CommonColor}">
				<local:BrushBoxControl BorderThickness="1" BorderBrush="{DynamicResource ControlBorderBrush}">
					<local:BrushBoxControl.Brush>
						<SolidColorBrush Color="{Binding Converter={StaticResource ColorConverter}}" />
					</local:BrushBoxControl.Brush>
				</local:BrushBoxControl>
			</DataTemplate>
			<DataTemplate DataType="{x:Type drawing:CommonBrush}">
				<local:BrushBoxControl Brush="{Binding Converter={StaticResource BrushConverter}}" BorderThickness="1" BorderBrush="{DynamicResource ControlBorderBrush}" />
			</DataTemplate>
		</DataTemplate.Resources>
		<ContentPresenter MinWidth="40" Content="{Binding Value}" />
	</DataTemplate>

	<Style x:Key="GroupSelectionItem" TargetType="RadioButton">
		<Setter Property="OverridesDefaultStyle" Value="True" />
		<Setter Property="Background" Value="Transparent" />
		<Setter Property="BorderThickness" Value="1" />
		<Setter Property="Padding" Value="20,2,4,2" />
		<Setter Property="MinHeight" Value="20" />
		<Setter Property="Template">
			<Setter.Value>
				<ControlTemplate TargetType="RadioButton">
					<Border BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Padding="{TemplateBinding Padding}" Background="{TemplateBinding Background}">
						<ContentPresenter />
					</Border>
					<ControlTemplate.Triggers>
						<Trigger Property="IsMouseOver" Value="True">
							<Setter Property="Background" Value="{DynamicResource ListItemMouseOverBackgroundBrush}" />
							<Setter Property="BorderBrush" Value="{DynamicResource ListItemMouseOverBorderBrush}" />
							<Setter Property="Foreground" Value="{DynamicResource ListItemMouseOverForegroundBrush}"/>
						</Trigger>
						<Trigger Property="IsChecked" Value="True">
							<Setter Property="Background" Value="{DynamicResource ListItemSelectedBackgroundBrush}" />
							<Setter Property="BorderBrush" Value="{DynamicResource ListItemSelectedBorderBrush}" />
							<Setter Property="Foreground" Value="{DynamicResource ListItemSelectedForegroundBrush}" />
						</Trigger>
					</ControlTemplate.Triggers>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>
	<Style TargetType="{x:Type local:GroupEditorControl}">
		<Setter Property="Margin" Value="-19,0,0,0" />
		<Setter Property="SelectorStyle">
			<Setter.Value>
				<Style TargetType="Border">
					<Setter Property="BorderBrush" Value="{DynamicResource ListBackgroundBrush}" />
					<Setter Property="Background" Value="{DynamicResource ListBackgroundBrush}" />
				</Style>
			</Setter.Value>
		</Setter>
		<Setter Property="ItemsSource" Value="{Binding Properties}" />
		<Setter Property="ItemTemplate">
			<Setter.Value>
				<DataTemplate DataType="vm:PropertyViewModel">
					<RadioButton GroupName="GroupSelection" Style="{StaticResource GroupSelectionItem}" Content="{Binding}">
						<RadioButton.ContentTemplate>
							<DataTemplate>
								<local:PropertyPresenter Label="{Binding Name,Mode=OneTime}" Background="Transparent" Content="{Binding Mode=OneTime}" ContentTemplate="{StaticResource GroupedPropertyValuePreview}" />
							</DataTemplate>
						</RadioButton.ContentTemplate>
					</RadioButton>
				</DataTemplate>
			</Setter.Value>
		</Setter>
		<Setter Property="ContentTemplateSelector" Value="{StaticResource GroupedEditorSelector}" />
		<Setter Property="ItemContainerStyle">
			<Setter.Value>
				<Style TargetType="ContentPresenter">
					<Setter Property="Width" Value="{Binding ActualWidth,RelativeSource={RelativeSource AncestorType=ItemsPresenter}}" />
				</Style>
			</Setter.Value>
		</Setter>
		<Setter Property="Template">
			<Setter.Value>
				<ControlTemplate TargetType="local:GroupEditorControl">
					<Grid>
						<Grid.RowDefinitions>
							<RowDefinition Height="Auto" />
							<RowDefinition Height="*" />
						</Grid.RowDefinitions>

						<Border Style="{TemplateBinding SelectorStyle}" Grid.Row="0">
							<ItemsPresenter Grid.IsSharedSizeScope="True" ScrollViewer.HorizontalScrollBarVisibility="Disabled" />
						</Border>
						<ContentPresenter Grid.Row="1" Name="EditorPresenter" IsEnabled="{Binding Property.CanWrite}" Content="{TemplateBinding SelectedItem}" ContentTemplate="{TemplateBinding ContentTemplate}" ContentTemplateSelector="{TemplateBinding ContentTemplateSelector}" />
					</Grid>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>

	<Style x:Key="ChoiceControlItem" BasedOn="{StaticResource {x:Type RadioButton}}" TargetType="RadioButton">
		<Setter Property="Background" Value="{DynamicResource ToggleItemBackgroundBrush}" />
		<Setter Property="BorderBrush" Value="{DynamicResource ToggleItemBorderBrush}" />
		<Setter Property="Foreground" Value="{DynamicResource ToggleItemForegroundBrush}" />
		<Setter Property="BorderThickness" Value="1" />
		<Setter Property="Padding" Value="4,2,4,2" />
		<Setter Property="Margin" Value="1,0,0,0" />
		<Setter Property="FocusVisualStyle" Value="{x:Null}" />
		<Setter Property="ToolTip" Value="{Binding Tooltip}" />
		<Setter Property="AutomationProperties.Name" Value="{Binding Name}" />
		<Setter Property="AutomationProperties.HelpText" Value="{Binding Tooltip}" />
		<Setter Property="Template">
			<Setter.Value>
				<ControlTemplate TargetType="RadioButton">
					<Border Background="{TemplateBinding Background}" BorderThickness="{TemplateBinding BorderThickness}" BorderBrush="{TemplateBinding BorderBrush}" Padding="{TemplateBinding Padding}">
						<ContentPresenter />
					</Border>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
		<Style.Triggers>
			<Trigger Property="IsChecked" Value="True">
				<Setter Property="BorderBrush" Value="{DynamicResource ToggleItemSelectedBorderBrush}" />
				<Setter Property="Background" Value="{DynamicResource ToggleItemSelectedBackgroundBrush}" />
				<Setter Property="Foreground" Value="{DynamicResource ToggleItemSelectedForegroundBrush}" />
			</Trigger>
			<Trigger Property="IsMouseOver" Value="True">
				<Setter Property="Background" Value="{DynamicResource ToggleItemMouseOverBackgroundBrush}" />
				<Setter Property="Foreground" Value="{DynamicResource ToggleItemMouseOverForegroundBrush}" />
			</Trigger>
			<Trigger Property="IsFocused" Value="True">
				<Setter Property="Background" Value="{DynamicResource ToggleItemMouseOverBackgroundBrush}" />
			</Trigger>
			<Trigger Property="IsPressed" Value="True">
				<Setter Property="BorderBrush" Value="{DynamicResource ToggleItemPressedBorderBrush}" />
				<Setter Property="Background" Value="{DynamicResource ToggleItemPressedBackgroundBrush}" />
			</Trigger>
		</Style.Triggers>
	</Style>

	<Style x:Key="PanelChoiceItem" BasedOn="{StaticResource ChoiceControlItem}" TargetType="RadioButton">
		<Setter Property="Padding" Value="1" />
		<Setter Property="Width" Value="22" />
	</Style>

	<Style TargetType="{x:Type local:ChoiceControl}">
		<Setter Property="Padding" Value="0" />
		<Setter Property="BorderThickness" Value="0,1,1,1" />
		<Setter Property="BorderBrush" Value="{DynamicResource ToggleItemOuterBorderBrush}" />
		<Setter Property="Background" Value="{DynamicResource ToggleItemOuterBorderBrush}" />
		<Setter Property="Focusable" Value="False" />
		<Setter Property="SelectedValuePath" Value="Value" />
		<Setter Property="ItemTemplate">
			<Setter.Value>
				<DataTemplate>
					<RadioButton Style="{DynamicResource ChoiceControlItem}" GroupName="{Binding Name,RelativeSource={RelativeSource FindAncestor,AncestorType=local:ChoiceControl},Mode=OneTime}">
						<Image Height="16" Width="16" Margin="-1" />
					</RadioButton>
				</DataTemplate>
			</Setter.Value>
		</Setter>
		<Setter Property="ItemsPanel">
			<Setter.Value>
				<ItemsPanelTemplate>
					<StackPanel Orientation="Horizontal" />
				</ItemsPanelTemplate>
			</Setter.Value>
		</Setter>
	</Style>

	<Style x:Key="PanelChoice" BasedOn="{StaticResource {x:Type local:ChoiceControl}}" TargetType="local:ChoiceControl">
		<Setter Property="ItemTemplate">
			<Setter.Value>
				<DataTemplate>
					<RadioButton Style="{DynamicResource PanelChoiceItem}" GroupName="{Binding Name,RelativeSource={RelativeSource FindAncestor,AncestorType=local:ChoiceControl},Mode=OneTime}">
						<Image Height="16" Width="16" Margin="-1" />
					</RadioButton>
				</DataTemplate>
			</Setter.Value>
		</Setter>
	</Style>

	<Style TargetType="local:StringEditorControl">
		<Setter Property="Height" Value="24" />
		<Setter Property="Template">
			<Setter.Value>
				<ControlTemplate TargetType="local:StringEditorControl">
					<local:TextBoxEx x:Name="TextBox" FocusSelectsAll="True" AutomationProperties.Name="{Binding Property.Name,Mode=OneTime}" Text="{Binding Value,UpdateSourceTrigger=Explicit}" IsEnabled="{Binding Property.CanWrite,Mode=OneTime}" VerticalContentAlignment="Center" />
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>

	<Style TargetType="local:BoolEditorControl">
		<Setter Property="Height" Value="24" />
		<Setter Property="Template">
			<Setter.Value>
				<ControlTemplate TargetType="local:BoolEditorControl">
					<CheckBox Name="CheckBox" Height="{TemplateBinding Height}" VerticalContentAlignment="Center" AutomationProperties.Name="{Binding Property.Name,Mode=OneTime}" IsChecked="{Binding Value}" IsEnabled="{Binding Property.CanWrite,Mode=OneTime}" VerticalAlignment="Center" />
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>

    <Style TargetType="local:PointEditorControl">
		<Setter Property="Height" Value="24" />
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="local:PointEditorControl">
					<Grid>
						<Grid.ColumnDefinitions>
							<ColumnDefinition Width="Auto" />
							<ColumnDefinition Width="*" />
							<ColumnDefinition Width="Auto" />
							<ColumnDefinition Width="*" />
						</Grid.ColumnDefinitions>
						<Label Grid.Column="0" Name="XLabel" Target="{Binding ElementName=XTextBox,Mode=OneTime}" Content="X" />
						<local:DoubleUpDownControl Grid.Column="1" x:Name="XTextBox" Value="{Binding X}" IsEnabled="{Binding Property.CanWrite,Mode=OneTime}" AutomationProperties.LabeledBy="{Binding ElementName=XLabel,Mode=OneTime}"/>
						<Label Grid.Column="2" Name="YLabel" Target="{Binding ElementName=YTextBox,Mode=OneTime}" Content="Y" />
						<local:DoubleUpDownControl Grid.Column="3" x:Name="YTextBox" Value="{Binding Y}" IsEnabled="{Binding Property.CanWrite,Mode=OneTime}" AutomationProperties.LabeledBy="{Binding ElementName=YLabel,Mode=OneTime}" />
					</Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>

    <Style TargetType="local:SizeEditorControl">
	    <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="local:SizeEditorControl">
                    <Grid>
						<Grid.ColumnDefinitions>
							<ColumnDefinition Width="Auto" />
							<ColumnDefinition Width="*" />
							<ColumnDefinition Width="Auto" />
							<ColumnDefinition Width="*" />
						</Grid.ColumnDefinitions>
						<Label Grid.Column="0" Name="WidthLabel" Target="{Binding ElementName=WidthTextBox,Mode=OneTime}" Content="Width" />
						<local:DoubleUpDownControl x:Name="WidthTextBox" Grid.Column="1" Value="{Binding Width}" IsEnabled="{Binding Property.CanWrite,Mode=OneTime}" AutomationProperties.LabeledBy="{Binding ElementName=WidthLabel,Mode=OneTime}"/>
						<Label Name="HeightLabel" Grid.Column="2" Target="{Binding ElementName=HeightTextBox,Mode=OneTime}" Content="Height" />
						<local:DoubleUpDownControl x:Name="HeightTextBox" Grid.Column="3" Value="{Binding Height}" IsEnabled="{Binding Property.CanWrite,Mode=OneTime}" AutomationProperties.LabeledBy="{Binding ElementName=HeightLabel,Mode=OneTime}"/>
					</Grid>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>

	<Style x:Key="EditorIconLabelHost" TargetType="Border">
		<Setter Property="Background" Value="{DynamicResource ThicknessIconBackgroundBrush}" />
		<Setter Property="BorderBrush" Value="{DynamicResource ThicknessIconBorderBrush}" />
		<Setter Property="BorderThickness" Value="1" />
		<Setter Property="Width" Value="20" />
		<Setter Property="VerticalAlignment" Value="Stretch" />
		<Setter Property="HorizontalAlignment" Value="Left" />
	</Style>

	<Style x:Key="ThicknessIconStyle" TargetType="Path">
		<Setter Property="Stroke" Value="{DynamicResource InputForegroundBrush}" />
		<Setter Property="Fill" Value="{DynamicResource InputForegroundBrush}" />
		<Setter Property="VerticalAlignment" Value="Center" />
	</Style>
	
	<Style TargetType="local:ThicknessEditorControl">
		<Setter Property="Template">
			<Setter.Value>
				<ControlTemplate TargetType="local:ThicknessEditorControl">
					<Grid>
						<Grid.ColumnDefinitions>
							<ColumnDefinition Width="*" />
							<ColumnDefinition Width="*" />
						</Grid.ColumnDefinitions>
						<Grid.RowDefinitions>
							<RowDefinition />
							<RowDefinition />
						</Grid.RowDefinitions>

						<Border Grid.Column="0" Grid.Row="0" Style="{StaticResource EditorIconLabelHost}">
							<Path Style="{StaticResource ThicknessIconStyle}" Data="{DynamicResource LeftThicknessGeometry}" />
						</Border>
						<local:IntegerUpDownControl Grid.Column="0" Grid.Row="0" Margin="14,0,2,0" Value="{Binding Left}" IsEnabled="{TemplateBinding IsEnabled}" AutomationProperties.Name="Left" />
						<Border Grid.Column="1" Grid.Row="0" Style="{StaticResource EditorIconLabelHost}">
							<Path Style="{StaticResource ThicknessIconStyle}" Data="{DynamicResource RightThicknessGeometry}" />
						</Border>
						<local:IntegerUpDownControl Grid.Column="1" Grid.Row="0" Margin="14,0,2,0" Value="{Binding Right}" IsEnabled="{TemplateBinding IsEnabled}" AutomationProperties.Name="Right" />
						<Border Grid.Column="0" Grid.Row="1" Style="{StaticResource EditorIconLabelHost}" Margin="0,4,0,0">
							<Path Style="{StaticResource ThicknessIconStyle}" Data="{DynamicResource TopThicknessGeometry}" />
						</Border>
						<local:IntegerUpDownControl Grid.Column="0" Grid.Row="1" Margin="14,4,2,0" Value="{Binding Top}" IsEnabled="{TemplateBinding IsEnabled}" AutomationProperties.Name="Top" />
						<Border Grid.Column="1" Grid.Row="1" Style="{StaticResource EditorIconLabelHost}" Margin="0,4,0,0">
							<Path Style="{StaticResource ThicknessIconStyle}" Data="{DynamicResource BottomThicknessGeometry}" />
						</Border>
						<local:IntegerUpDownControl Grid.Column="1" Grid.Row="1" Margin="14,4,2,0" Value="{Binding Bottom}" IsEnabled="{TemplateBinding IsEnabled}" AutomationProperties.Name="Bottom" />
					</Grid>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>

	<Style TargetType="local:ObjectEditorControl">
		<Setter Property="Template">
			<Setter.Value>
				<ControlTemplate TargetType="local:ObjectEditorControl">
					<Grid>
						<Grid.ColumnDefinitions>
							<ColumnDefinition Width="*" />
							<ColumnDefinition Width="Auto" />
						</Grid.ColumnDefinitions>

						<TextBlock Text="{Binding ValueType.Name,StringFormat=({0})}" Grid.Column="0" VerticalAlignment="Center" />
						<Button MinHeight="20" MinWidth="40" Grid.Column="1" HorizontalAlignment="Right" Content="{x:Static prop:Resources.New}" Command="{Binding CreateInstanceCommand}" />
					</Grid>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>

	<system:Double x:Key="MenuOffset">3</system:Double>

	<Style x:Key="MarkerStyle" TargetType="Rectangle">
		<Setter Property="Width" Value="12" />
		<Setter Property="Height" Value="12" />
		<Setter Property="Stroke" Value="{DynamicResource PropertyButtonBorderBrush}" />
		<Setter Property="StrokeThickness" Value="1" />
	</Style>

	<Rectangle x:Shared="False" x:Key="LiteralMarker" Style="{StaticResource MarkerStyle}" Fill="{DynamicResource LiteralMarkerBrush}" />
	<Rectangle x:Shared="False" x:Key="ResourceMarker" Style="{StaticResource MarkerStyle}" Fill="{DynamicResource ResourceMarkerBrush}" />
	<Rectangle x:Shared="False" x:Key="SourceMarker" Style="{StaticResource MarkerStyle}" Fill="{Binding Foreground,RelativeSource={RelativeSource AncestorType=local:PropertyButton,Mode=FindAncestor}}" />

	<Style TargetType="local:PropertyButton">
		<Setter Property="Foreground" Value="Transparent" />
		<Setter Property="Background" Value="Transparent" />
		<Setter Property="BorderThickness" Value="0" />
		<Setter Property="Height" Value="17" />
		<Setter Property="Width" Value="11" />
		<Setter Property="SnapsToDevicePixels" Value="True" />
		<Setter Property="MenuTemplate">
			<Setter.Value>
				<DataTemplate>
					<local:HeaderedContextMenu Header="{Binding Property.Name,Mode=OneTime}" StaysOpen="True" Placement="Left" HorizontalOffset="{StaticResource MenuOffset}" VerticalOffset="{StaticResource MenuOffset}">
						<MenuItem x:Name="CustomExpressionItem" Header="{x:Static prop:Resources.CustomExpressionEllipsis}" Icon="{StaticResource LiteralMarker}" Visibility="{Binding TargetPlatform.SupportsCustomExpressions,Mode=OneTime,Converter={StaticResource BoolToVisibilityConverter}}" />
						<Separator Visibility="{Binding TargetPlatform.SupportsCustomExpressions,Mode=OneTime,Converter={StaticResource BoolToVisibilityConverter}}" />
						<MenuItem Header="{x:Static prop:Resources.Reset}" Icon="{StaticResource LiteralMarker}" Command="{Binding ClearValueCommand,Mode=OneTime}" />
						<MenuItem Header="{x:Static prop:Resources.ConvertToLocalValue}" Icon="{StaticResource LiteralMarker}" Command="{Binding ConvertToLocalValueCommand,Mode=OneTime}" />
						<Separator Visibility="{Binding SupportsResources,Mode=OneTime,Converter={StaticResource BoolToVisibilityConverter}}" />
						<MenuItem Header="{x:Static prop:Resources.ResourceEllipsis}" Command="{Binding RequestResourceCommand,Mode=OneTime}" Icon="{StaticResource ResourceMarker}" Visibility="{Binding SupportsResources,Mode=OneTime,Converter={StaticResource BoolToVisibilityConverter}}" />
						<!--<MenuItem Header="{x:Static prop:Resources.LocalResource}" />
						<MenuItem Header="{x:Static prop:Resources.SystemResource}" />
						<MenuItem Header="{x:Static prop:Resources.EditResourceEllipse}" />
						<MenuItem Header="{x:Static prop:Resources.ConvertToNewResourceEllipse}" />
						<Separator />
						<MenuItem Header="{x:Static prop:Resources.CreateDataBindingEllipse}" />
						<MenuItem Header="{x:Static prop:Resources.TemplateBinding}" />!-->
						<Separator Visibility="{Binding SupportsValueSourceNavigation,Mode=OneTime,Converter={StaticResource BoolToVisibilityConverter}}" />
						<!--<MenuItem Header="{x:Static prop:Resources.RecordCurrentValue}" />!-->
						<MenuItem Header="{x:Static prop:Resources.GoToSource}" Command="{Binding NavigateToValueSourceCommand,Mode=OneTime}" Icon="{StaticResource SourceMarker}" Visibility="{Binding SupportsValueSourceNavigation,Mode=OneTime,Converter={StaticResource BoolToVisibilityConverter}}" />
					</local:HeaderedContextMenu>
				</DataTemplate>
			</Setter.Value>
		</Setter>
		<Setter Property="Template">
			<Setter.Value>
				<ControlTemplate TargetType="local:PropertyButton">
					<Border Name="Border" BorderThickness="{TemplateBinding BorderThickness}" BorderBrush="{TemplateBinding BorderBrush}" Background="{TemplateBinding Background}">
						<Rectangle Name="Indicator" Fill="{TemplateBinding Foreground}" Stroke="{DynamicResource PropertyButtonBorderBrush}" Height="7" Width="7" />
					</Border>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
		<Style.Triggers>
			<Trigger Property="IsMouseOver" Value="True">
				<Trigger.Setters>
					<Setter Property="Background" Value="{DynamicResource ToggleItemMouseOverBackgroundBrush}" />
				</Trigger.Setters>
			</Trigger>
			<Trigger Property="ValueSource" Value="Local">
				<Setter Property="Foreground" Value="{DynamicResource PropertyLocalValueBrush}" />
			</Trigger>
			<Trigger Property="ValueSource" Value="Binding">
				<Setter Property="Foreground" Value="{DynamicResource PropertyBoundValueBrush}" />
			</Trigger>
			<Trigger Property="ValueSource" Value="Inherited">
				<Setter Property="Foreground" Value="{DynamicResource PropertyResourceBrush}" />
			</Trigger>
			<Trigger Property="ValueSource" Value="DefaultStyle">
				<Setter Property="Foreground" Value="{DynamicResource PropertyResourceBrush}" />
			</Trigger>
			<Trigger Property="ValueSource" Value="Style">
				<Setter Property="Foreground" Value="{DynamicResource PropertyResourceBrush}" />
			</Trigger>
			<Trigger Property="ValueSource" Value="Resource">
				<Setter Property="Foreground" Value="{DynamicResource PropertyResourceBrush}" />
			</Trigger>
		</Style.Triggers>
	</Style>

	<Style x:Key="CustomExpressionPopup" TargetType="local:EntryPopup">
		<Setter Property="Placement" Value="Bottom" />
		<Setter Property="Width" Value="400" />
		<Setter Property="StaysOpen" Value="False" />
		<Setter Property="ContentTemplate">
			<Setter.Value>
				<DataTemplate>
					<Border BorderThickness="1" BorderBrush="{DynamicResource PopupBorderBrush}" Background="{DynamicResource PopupBackgroundBrush}" TextElement.Foreground="{DynamicResource PopupForegroundBrush}">
						<Grid>
							<Grid.RowDefinitions>
								<RowDefinition />
								<RowDefinition />
							</Grid.RowDefinitions>

							<TextBlock Name="label" Grid.Row="0" Margin="5,5,0,5" FontWeight="Bold" Text="{x:Static prop:Resources.CustomExpression}" />
							<local:TextBoxEx x:Name="entry" Grid.Row="1" Margin="5,0,5,5" AutomationProperties.LabeledBy="{Binding Mode=OneTime,ElementName=label}" FocusSelectsAll="True" Text="{Binding CustomExpression,Mode=TwoWay,UpdateSourceTrigger=Explicit}" />
						</Grid>
					</Border>
				</DataTemplate>
			</Setter.Value>
		</Setter>
	</Style>

	<Style x:Key="LargeResourcePreview" TargetType="ContentPresenter">
		<Setter Property="ContentTemplateSelector">
			<Setter.Value>
				<local:PreviewTemplateSelector>
					<local:PreviewTemplateSelector.FallbackTemplate>
						<DataTemplate>
							<TextBlock VerticalAlignment="Center" HorizontalAlignment="Center" Text="{x:Static prop:Resources.NoPreviewAvailable}" FontSize="16" />
						</DataTemplate>
					</local:PreviewTemplateSelector.FallbackTemplate>
					<local:PreviewTemplateSelector.Templates>
						<DataTemplate DataType="{x:Type drawing:CommonColor}">
							<local:BrushBoxControl BorderThickness="0">
								<local:BrushBoxControl.Brush>
									<SolidColorBrush Color="{Binding Converter={StaticResource ColorConverter}}" />
								</local:BrushBoxControl.Brush>
							</local:BrushBoxControl>
						</DataTemplate>
						<DataTemplate DataType="{x:Type drawing:CommonBrush}">
							<local:BrushBoxControl BorderThickness="0" Brush="{Binding Converter={StaticResource BrushConverter}}" />
						</DataTemplate>
						<DataTemplate DataType="{x:Type system:String}">
							<TextBlock Margin="4" VerticalAlignment="Center" HorizontalAlignment="Center" TextWrapping="Wrap" Text="{Binding Mode=OneTime}" />
						</DataTemplate>
					</local:PreviewTemplateSelector.Templates>
				</local:PreviewTemplateSelector>
			</Setter.Value>
		</Setter>
	</Style>

	<Style x:Key="ComplexResourcePreview" TargetType="ContentPresenter">
		<Style.Resources>
			<DataTemplate DataType="{x:Type drawing:CommonColor}">
				<StackPanel Orientation="Horizontal">
					<local:BrushBoxControl Margin="4" Height="14" Width="26" BorderBrush="{DynamicResource ControlBorderBrush}" BorderThickness="1">
						<local:BrushBoxControl.Brush>
							<SolidColorBrush Color="{Binding Converter={StaticResource ColorConverter}}" />
						</local:BrushBoxControl.Brush>
					</local:BrushBoxControl>

					<TextBlock Margin="4" VerticalAlignment="Center" Text="{Binding Mode=OneTime}" />
				</StackPanel>
			</DataTemplate>
			<DataTemplate DataType="{x:Type drawing:CommonSolidBrush}">
				<StackPanel Orientation="Horizontal">
					<local:BrushBoxControl Margin="4" Height="14" Width="26" Brush="{Binding Converter={StaticResource BrushConverter}}"  BorderBrush="{DynamicResource ControlBorderBrush}" BorderThickness="1" />
					<TextBlock Margin="4" Text="{Binding Color,Mode=OneTime}" VerticalAlignment="Center" />
				</StackPanel>
			</DataTemplate>
			<DataTemplate DataType="{x:Type drawing:CommonImageBrush}">
				<local:BrushBoxControl Margin="4" Height="14" Brush="{Binding Converter={StaticResource BrushConverter}}"  BorderBrush="{DynamicResource ControlBorderBrush}" BorderThickness="1" />
			</DataTemplate>
			<DataTemplate DataType="{x:Type system:String}">
				<TextBlock Margin="4" Text="{Binding Mode=OneTime}" />
			</DataTemplate>
		</Style.Resources>
	</Style>

	<DataTemplate x:Key="SimpleResourcePreviewItem">
		<DataTemplate.Resources>
			<DataTemplate DataType="{x:Type drawing:CommonColor}">
				<local:BrushBoxControl>
					<local:BrushBoxControl.Brush>
						<SolidColorBrush Color="{Binding Converter={StaticResource ColorConverter}}" />
					</local:BrushBoxControl.Brush>
				</local:BrushBoxControl>
			</DataTemplate>
			<DataTemplate DataType="{x:Type drawing:CommonBrush}">
				<local:BrushBoxControl Brush="{Binding Converter={StaticResource BrushConverter}}" />
			</DataTemplate>
		</DataTemplate.Resources>
		<StackPanel Orientation="Horizontal" Margin="4,2,4,2">
			<Border Margin="4,2,0,2" BorderThickness="1" BorderBrush="{DynamicResource ControlBorderBrush}">
				<ContentPresenter MinWidth="40" Content="{Binding Value,Mode=OneTime}" />
			</Border>
			<TextBlock VerticalAlignment="Center" Text="{Binding Name,Mode=OneTime}" Margin="4,0,0,0" />
		</StackPanel>
	</DataTemplate>

	<Style x:Key="BrushBoxFocusVisual">
		<Setter Property="Control.Template">
			<Setter.Value>
				<ControlTemplate>
					<Rectangle StrokeThickness="1" Margin="0" Stroke="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" StrokeDashArray="1 2" SnapsToDevicePixels="true"/>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>

	<Style TargetType="local:BrushEditorControl">
		<Setter Property="Template">
			<Setter.Value>
				<ControlTemplate TargetType="local:BrushEditorControl">
					<Grid>
						<local:BrushBoxControl Brush="{Binding Value, Converter={local:CommonBrushToBrushConverter}}"
											   HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Grid.Row="0" Grid.Column="0"
											   Height="24" BorderThickness="1" BorderBrush="{DynamicResource InputBorderBrush}"/>
						<ToggleButton x:Name="brushBoxButton" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Grid.Row="0" Grid.Column="0" BorderThickness="0" Background="Transparent" Opacity="0"
									  IsEnabled="{TemplateBinding IsEnabled}" FocusVisualStyle="{StaticResource BrushBoxFocusVisual}"
									  IsHitTestVisible="{Binding ElementName=brushBoxPopup, Path=IsOpen, Mode=OneWay, Converter={StaticResource OppositeBoolConverter}}"
									  AutomationProperties.Name="{Binding Property.Name,Mode=OneTime}"/>
						<Popup x:Name="brushBoxPopup" StaysOpen="False" MaxWidth="300" Width="300" PopupAnimation="Slide" AllowsTransparency="True"
							IsOpen="{Binding ElementName=brushBoxButton, Path=IsChecked}">
							<theme:SystemDropShadowChrome x:Name="shadow" Color="{DynamicResource DropShadowBackgroundColor}" Margin="0,0,5,5">
								<Border x:Name="dropDownBorder" BorderBrush="{DynamicResource ComboBoxPopupBorderBrush}" BorderThickness="1" Background="{DynamicResource ComboBoxPopupBackgroundBrush}">
									<Grid>
										<Rectangle VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Grid.Column="0" Grid.Row="0"
											Fill="{DynamicResource MenuPopupBackgroundBrush}" Stroke="{DynamicResource MenuPopupBorderBrush}"/>
										<local:BrushTabbedEditorControl Grid.Column="0" Grid.Row="0"/>
									</Grid>
								</Border>
							</theme:SystemDropShadowChrome>
						</Popup>
					</Grid>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>

	<Style x:Key="BrushChoiceItem" TargetType="RadioButton" BasedOn="{StaticResource ChoiceControlItem}">
		<Setter Property="GroupName" Value="brushChoiceType" />
		<Setter Property="MinHeight" Value="20" />
		<Setter Property="MinWidth" Value="20" />
		<Setter Property="ToolTip" Value="{Binding Key,Mode=OneTime}" />
		<Setter Property="AutomationProperties.Name" Value="{Binding Key,Mode=OneTime}" />
		<Setter Property="AutomationProperties.HelpText" Value="{Binding Key,Mode=OneTime}" />
	</Style>

	<local:BrushChoiceTemplateSelector x:Key="BrushChoiceTemplateSelector">
		<local:BrushChoiceTemplateSelector.NoBrushTemplate>
			<DataTemplate>
				<RadioButton Style="{DynamicResource BrushChoiceItem}">
					<ContentControl ContentTemplate="{DynamicResource BrushChoiceNoBrushIcon}"/>
				</RadioButton>
			</DataTemplate>
		</local:BrushChoiceTemplateSelector.NoBrushTemplate>
		<local:BrushChoiceTemplateSelector.SolidBrushTemplate>
			<DataTemplate>
				<RadioButton Style="{DynamicResource BrushChoiceItem}">
					<ContentControl ContentTemplate="{DynamicResource BrushChoiceSolidBrushIcon}"/>
				</RadioButton>
			</DataTemplate>
		</local:BrushChoiceTemplateSelector.SolidBrushTemplate>
		<local:BrushChoiceTemplateSelector.MaterialDesignBrushTemplate>
			<DataTemplate>
				<RadioButton Style="{DynamicResource BrushChoiceItem}">
					<ContentControl ContentTemplate="{DynamicResource BrushChoiceMaterialDesignIcon}"/>
				</RadioButton>
			</DataTemplate>
		</local:BrushChoiceTemplateSelector.MaterialDesignBrushTemplate>
		<local:BrushChoiceTemplateSelector.ImageBrushTemplate>
			<DataTemplate>
				<RadioButton Style="{DynamicResource BrushChoiceItem}">
					<ContentControl ContentTemplate="{DynamicResource BrushChoiceImageBrushIcon}"/>
				</RadioButton>
			</DataTemplate>
		</local:BrushChoiceTemplateSelector.ImageBrushTemplate>
		<local:BrushChoiceTemplateSelector.ResourceBrushTemplate>
			<DataTemplate>
				<RadioButton Style="{DynamicResource BrushChoiceItem}">
					<ContentControl ContentTemplate="{DynamicResource BrushChoiceResourceBrushIcon}"/>
				</RadioButton>
			</DataTemplate>
		</local:BrushChoiceTemplateSelector.ResourceBrushTemplate>
	</local:BrushChoiceTemplateSelector>

	<Style TargetType="local:BrushTabbedEditorControl">
		<Setter Property="Template">
			<Setter.Value>
				<ControlTemplate TargetType="local:BrushTabbedEditorControl">
					<StackPanel>
						<Border Padding="8,10,8,4">
							<StackPanel>
								<local:ChoiceControl x:Name="brushChoice"
													 SelectedValue="{Binding SelectedBrushType,Mode=TwoWay}" SelectedValuePath="Value"
													 ItemsSource="{Binding BrushTypes,Mode=OneTime}"
													 ItemTemplateSelector="{StaticResource BrushChoiceTemplateSelector}"
													 ItemTemplate="{x:Null}" HorizontalAlignment="Stretch" />
								<local:SolidBrushEditorControl x:Name="solidBrushEditor" Visibility="Collapsed" />
								<local:MaterialDesignColorEditorControl x:Name="materialDesignColorEditor" Visibility="Collapsed" />
								<local:ImageBrushEditorControl x:Name="imageBrushEditor" Visibility="Collapsed" />
								<local:ResourceBrushEditorControl x:Name="resourceBrushEditor" Visibility="Collapsed" />
							</StackPanel>
						</Border>
						<Border Padding="1" Visibility="{Binding TargetPlatform.SupportsBrushOpacity, Mode=OneTime, Converter={StaticResource BoolToVisibilityConverter}}">
							<Expander Name="advancedPropertyPanel" Template="{DynamicResource AdvancedPropertiesExpander}" HorizontalAlignment="Stretch" HorizontalContentAlignment="Stretch"
								  Background="{DynamicResource PanelGroupSecondaryBackgroundBrush}" Foreground="{DynamicResource PanelForegroundBrush}">
								<Expander.Content>
									<Border Padding="19,6,6,6" Background="{DynamicResource PanelGroupSecondaryBackgroundBrush}">
										<local:PropertyPresenter Label="{x:Static prop:Resources.Opacity}" ShowPropertyButton="False">
											<local:ColorComponentBox
												Value="{Binding Path=Opacity, Converter={local:DoubleToPercentageConverter}, Mode=TwoWay}" Unit="%"
												ToolTip="{x:Static prop:Resources.Opacity}" AutomationProperties.Name="{x:Static prop:Resources.Opacity}" AutomationProperties.HelpText="{x:Static prop:Resources.Opacity}"
												HorizontalAlignment="Stretch" HorizontalContentAlignment="Left"/>
										</local:PropertyPresenter>
									</Border>
								</Expander.Content>
							</Expander>
						</Border>
					</StackPanel>
					<ControlTemplate.Triggers>
						<DataTrigger Binding="{Binding SelectedBrushType}" Value="{x:Static drawing:CommonBrushType.Solid}">
							<Setter TargetName="solidBrushEditor" Property="Visibility" Value="Visible" />
						</DataTrigger>
						<DataTrigger Binding="{Binding SelectedBrushType}" Value="{x:Static drawing:CommonBrushType.MaterialDesign}">
							<Setter TargetName="materialDesignColorEditor" Property="Visibility" Value="Visible" />
						</DataTrigger>
						<DataTrigger Binding="{Binding SelectedBrushType}" Value="{x:Static drawing:CommonBrushType.Image}">
							<Setter TargetName="imageBrushEditor" Property="Visibility" Value="Visible" />
						</DataTrigger>
						<DataTrigger Binding="{Binding SelectedBrushType}" Value="{x:Static drawing:CommonBrushType.Resource}">
							<Setter TargetName="resourceBrushEditor" Property="Visibility" Value="Visible" />
						</DataTrigger>
					</ControlTemplate.Triggers>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>

	<Style TargetType="local:ResourceBrushEditorControl">
		<Setter Property="Template">
			<Setter.Value>
				<ControlTemplate TargetType="local:ResourceBrushEditorControl">
					<StackPanel Orientation="Vertical">
						<ListBox Height="100" Name="resourceList" Grid.Row="1" Margin="0,4,0,0" SelectedItem="{Binding Resource}" ItemsSource="{Binding ResourceSelector.Resources}" HorizontalContentAlignment="Stretch" BorderThickness="1" >
							<ListBox.ItemTemplate>
								<DataTemplate>
									<Grid Margin="12,0,12,0">
										<Grid.ColumnDefinitions>
											<ColumnDefinition Width="Auto" />
											<ColumnDefinition Width="*" />
											<ColumnDefinition Width="100" />
										</Grid.ColumnDefinitions>

										<TextBlock Grid.Column="1" Text="{Binding Name,Mode=OneTime}" VerticalAlignment="Center" />
										<ContentPresenter Grid.Column="2" Content="{Binding Value,Mode=OneTime}" Style="{DynamicResource ComplexResourcePreview}" />
									</Grid>
								</DataTemplate>
							</ListBox.ItemTemplate>
						</ListBox>
					</StackPanel>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>
	<Style TargetType="local:SolidBrushEditorControl">
		<Setter Property="Template">
			<Setter.Value>
				<ControlTemplate TargetType="local:SolidBrushEditorControl">
					<!--<TabControl Margin="0,4,0,0">
						<TabItem>
							<TabItem.Header>
								<local:PropertyPresenter Label="{x:Static prop:Resources.ColorEditorTabLabel}"/>
							</TabItem.Header>-->
					<StackPanel Orientation="Vertical">
						<local:PropertyPresenter x:Name="colorSpacePresenter" Label="{x:Static prop:Resources.ColorSpace}" ShowPropertyButton="false">
							<ComboBox Name="colorSpacePicker" ItemsSource="{Binding Solid.ColorSpaces}"
								SelectedItem="{Binding Solid.ColorSpace, Mode=OneTime}" VerticalContentAlignment="Center"
								AutomationProperties.Name="{x:Static prop:Resources.ColorSpace}"
								AutomationProperties.HelpText="{x:Static prop:Resources.ColorSpace}" ToolTip="{x:Static prop:Resources.ColorSpace}"/>
						</local:PropertyPresenter>
						<Grid VerticalAlignment="Top" Margin="0,6,0,0" MinHeight="180">
							<Grid.ColumnDefinitions>
								<ColumnDefinition Width="*" MinWidth="150"/>
								<ColumnDefinition Width="Auto"/>
							</Grid.ColumnDefinitions>
							<Grid Grid.Row="1" Grid.Column="0" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
								<Grid.RowDefinitions>
									<RowDefinition Height="*"/>
									<RowDefinition Height="Auto"/>
								</Grid.RowDefinitions>
								<Grid.ColumnDefinitions>
									<ColumnDefinition Width="*"/>
									<ColumnDefinition Width="Auto"/>
								</Grid.ColumnDefinitions>
								<local:ShadeEditorControl x:Name="shadeChooser"
									Shade="{Binding Path=Solid.Shade, Mode=TwoWay}"
									HueColor="{Binding Path=Solid.HueColor, Mode=OneWay}"
									Grid.Column="0" Grid.Row="0" VerticalAlignment="Stretch" HorizontalAlignment="Stretch"
									Margin="0,6,0,1" Panel.ZIndex="1"/>
								<local:HueEditorControl
									x:Name="hueChooser" HueColor="{Binding Path=Solid.HueColor, Mode=TwoWay}"
									Grid.Column="1" Grid.ColumnSpan="1" Grid.Row="0" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Margin="1,6,3,1" Panel.ZIndex="0" Focusable="False"/>
								<local:CurrentColorEditorControl
									Color="{Binding Path=Solid.Color, Mode=TwoWay}"
									InitialColor="{Binding Solid.InitialColor}"
									LastColor="{Binding Solid.LastColor}"
									Grid.Column="0" Grid.Row="1" HorizontalAlignment="Stretch" Height="20"
									Margin="0,0,0,0" Panel.ZIndex="0" Focusable="False"/>
							</Grid>
							<local:ColorComponentsEditorControl x:Name="componentEditor"
								Color="{Binding Path=Solid.Color, Mode=TwoWay}"
								HueColor="{Binding Path=Solid.HueColor, Mode=TwoWay}"
								Grid.Column="1" Grid.Row="1" Grid.RowSpan="2"
								VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Margin="0,4,0,0" Focusable="False"/>
						</Grid>
					</StackPanel>
						<!--</TabItem>
						<TabItem>
							<TabItem.Header>
								<Label>Color Resources</Label>
							</TabItem.Header>
						</TabItem>
					</TabControl>-->
					<ControlTemplate.Triggers>
						<DataTrigger Binding="{Binding Solid.ColorSpaces}" Value="{x:Null}">
							<Setter TargetName="colorSpacePresenter" Property="Visibility" Value="Collapsed"/>
						</DataTrigger>
					</ControlTemplate.Triggers>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>

	<SolidColorBrush x:Key="HueSelectionGlyphBrush">#000000</SolidColorBrush>

	<Style TargetType="local:HueEditorControl">
		<Setter Property="Focusable" Value="False"/>
		<Setter Property="Template">
			<Setter.Value>
				<ControlTemplate TargetType="local:HueEditorControl">
					<Grid>
						<Rectangle Name="hueChooser" Grid.Column="0" Grid.Row="0" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Width="20" Stroke="Transparent" StrokeThickness="0">
							<Rectangle.Fill>
								<LinearGradientBrush EndPoint="0,1" StartPoint="0,0">
									<GradientStop Color="Red" Offset="0"/>
									<GradientStop Color="Yellow" Offset="0.167"/>
									<GradientStop Color="Lime" Offset="0.333"/>
									<GradientStop Color="Cyan" Offset="0.500"/>
									<GradientStop Color="Blue" Offset="0.667"/>
									<GradientStop Color="Magenta" Offset="0.833"/>
									<GradientStop Color="Red" Offset="1"/>
								</LinearGradientBrush>
							</Rectangle.Fill>
						</Rectangle>
						<Canvas Name="cursorCanvas" Grid.Column="0" Grid.Row="0" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Width="20" Panel.ZIndex="1" ClipToBounds="True">
							<Canvas Width="{Binding ActualWidth, ElementName=cursorCanvas}" Height="{Binding ActualHeight, ElementName=cursorCanvas}"
									Canvas.Top="{TemplateBinding CursorPosition}">
								<Canvas.RenderTransform><TranslateTransform X="0" Y="-4"/></Canvas.RenderTransform>
								<Polygon Points="0,0 5,5 0,10" Stroke="{DynamicResource HueSelectionGlyphBrush}" Fill="{DynamicResource HueSelectionGlyphBrush}"/>
								<Polygon Points="20,0 15,5 20,10" Stroke="{DynamicResource HueSelectionGlyphBrush}" Fill="{DynamicResource HueSelectionGlyphBrush}"/>
							</Canvas>
						</Canvas>
					</Grid>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>

	<Color x:Key="ShadePickerCursorStrokeColor">#000000</Color>
	<Color x:Key="ShadePickerCursorOutlineColor">#FFFFFF</Color>

	<Style TargetType="local:ShadeEditorControl">
		<Setter Property="Focusable" Value="False"/>
		<Setter Property="Template">
			<Setter.Value>
				<ControlTemplate TargetType="local:ShadeEditorControl">
					<Grid HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
						<Rectangle Name="saturationLayer" HorizontalAlignment="Stretch" Grid.Row="0" Grid.Column="0" Stroke="Transparent" StrokeThickness="0" VerticalAlignment="Stretch">
							<Rectangle.Fill>
								<LinearGradientBrush EndPoint="1,0" StartPoint="0,0">
									<GradientStop Color="White" Offset="0"/>
									<GradientStop Color="Red" Offset="1"/>
								</LinearGradientBrush>
							</Rectangle.Fill>
						</Rectangle>
						<Rectangle Name="brightnessLayer" HorizontalAlignment="Stretch" Grid.Row="0" Grid.Column="0" Stroke="Transparent" StrokeThickness="0" VerticalAlignment="Stretch" Panel.ZIndex="1">
							<Rectangle.Fill>
								<LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
									<GradientStop Color="#00000000" Offset="0"/>
									<GradientStop Color="Black" Offset="1"/>
								</LinearGradientBrush>
							</Rectangle.Fill>
						</Rectangle>
						<Canvas Name="cursor" HorizontalAlignment="Stretch" Grid.Row="0" Grid.Column="0" VerticalAlignment="Stretch" Panel.ZIndex="2" IsHitTestVisible="False">
							<Canvas.RenderTransform><TranslateTransform X="-6" Y="-6"/></Canvas.RenderTransform>
							<Rectangle IsHitTestVisible="False" Width="12" Height="12" StrokeThickness="0"
									Canvas.Left="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=CursorPosition.X}"
									Canvas.Top="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=CursorPosition.Y}">
								<Rectangle.Fill>
									<RadialGradientBrush Center="0.5,0.5" GradientOrigin="0.5,0.5">
										<RadialGradientBrush.GradientStops>
											<GradientStop Offset="0" Color="Transparent"/>
											<GradientStop Offset="0.5" Color="Transparent"/>
											<GradientStop Offset="0.5" Color="{DynamicResource ShadePickerCursorOutlineColor}"/>
											<GradientStop Offset="0.67" Color="{DynamicResource ShadePickerCursorOutlineColor}"/>
											<GradientStop Offset="0.67" Color="{DynamicResource ShadePickerCursorStrokeColor}"/>
											<GradientStop Offset="0.83" Color="{DynamicResource ShadePickerCursorStrokeColor}"/>
											<GradientStop Offset="0.83" Color="{DynamicResource ShadePickerCursorOutlineColor}"/>
											<GradientStop Offset="1" Color="{DynamicResource ShadePickerCursorOutlineColor}"/>
											<GradientStop Offset="1" Color="Transparent"/>
										</RadialGradientBrush.GradientStops>
									</RadialGradientBrush>
								</Rectangle.Fill>
							</Rectangle>
						</Canvas>
					</Grid>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>

	<Style TargetType="local:ColorComponentsEditorControl">
		<Setter Property="Focusable" Value="False"/>
		<Setter Property="ContextMenu">
			<Setter.Value>
				<ContextMenu Placement="Bottom">
					<MenuItem Name="hlsMenuItem" Header="{x:Static prop:Resources.HLS}" ToolTip="{x:Static prop:Resources.HueLightnessSaturation}" AutomationProperties.HelpText="{x:Static prop:Resources.HueLightnessSaturation}"/>
					<MenuItem Name="hsbMenuItem" Header="{x:Static prop:Resources.HSB}" ToolTip="{x:Static prop:Resources.HueSaturationBrightness}" AutomationProperties.HelpText="{x:Static prop:Resources.HueSaturationBrightness}"/>
					<MenuItem Name="rgbMenuItem" Header="{x:Static prop:Resources.RGB}" ToolTip="{x:Static prop:Resources.RedGreenBlue}" AutomationProperties.HelpText="{x:Static prop:Resources.RedGreenBlue}"/>
					<MenuItem Name="cmykMenuItem" Header="{x:Static prop:Resources.CMYK}" ToolTip="{x:Static prop:Resources.CyanMagentaYellowBlack}" AutomationProperties.HelpText="{x:Static prop:Resources.CyanMagentaYellowBlack}"/>
				</ContextMenu>
			</Setter.Value>
		</Setter>
		<Setter Property="Template">
			<Setter.Value>
				<ControlTemplate TargetType="local:ColorComponentsEditorControl">
					<Grid>
						<Grid.RowDefinitions>
							<RowDefinition Height="Auto"/>
							<RowDefinition Height="*"/>
						</Grid.RowDefinitions>
						
						<Grid x:Name="hlsPane" Visibility="Collapsed" Grid.Row="0" Grid.Column="0">
							<Grid.RowDefinitions>
								<RowDefinition Height="Auto" MinHeight="22"/>
								<RowDefinition Height="Auto" MinHeight="22"/>
								<RowDefinition Height="Auto" MinHeight="22"/>
								<RowDefinition Height="Auto" MinHeight="22"/>
							</Grid.RowDefinitions>
							<Grid.ColumnDefinitions>
								<ColumnDefinition Width="23"/>
								<ColumnDefinition Width="77"/>
							</Grid.ColumnDefinitions>
							
							<Button HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Grid.Column="0" Grid.Row="0" Opacity="0" FocusVisualStyle="{x:Null}" Panel.ZIndex="1" IsTabStop="False"
									ToolTip="{x:Static prop:Resources.Hue}" AutomationProperties.Name="{x:Static prop:Resources.Hue}" AutomationProperties.HelpText="{x:Static prop:Resources.Hue}"/>
							<Label HorizontalAlignment="Right" VerticalAlignment="Center" Grid.Column="0" Grid.Row="0" Margin="3,0,0,0">
								<TextBlock TextDecorations="Underline" Text="{x:Static prop:Resources.HueInitial}"/>
							</Label>
							<local:ColorComponentBox x:Name="hueEntry"
								HorizontalAlignment="Stretch" VerticalAlignment="Center" Grid.Column="1" Grid.Row="0"
								AutomationProperties.Name="{x:Static prop:Resources.Hue}" AutomationProperties.HelpText="{x:Static prop:Resources.Hue}" ToolTip="{x:Static prop:Resources.Hue}"
								Value="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Hue, Mode=TwoWay}" Unit="°">
								<local:ColorComponentBox.GradientBrush>
									<LinearGradientBrush EndPoint="1,0" StartPoint="0,0">
										<GradientStop Color="Red" Offset="0"/>
										<GradientStop Color="Yellow" Offset="0.167"/>
										<GradientStop Color="Lime" Offset="0.333"/>
										<GradientStop Color="Cyan" Offset="0.500"/>
										<GradientStop Color="Blue" Offset="0.667"/>
										<GradientStop Color="Magenta" Offset="0.833"/>
										<GradientStop Color="Red" Offset="1"/>
									</LinearGradientBrush>
								</local:ColorComponentBox.GradientBrush>
							</local:ColorComponentBox>

							<Button HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Grid.Column="0" Grid.Row="1" Opacity="0" FocusVisualStyle="{x:Null}" Panel.ZIndex="1" IsTabStop="False"
									ToolTip="{x:Static prop:Resources.Lightness}" AutomationProperties.Name="{x:Static prop:Resources.Lightness}" AutomationProperties.HelpText="{x:Static prop:Resources.Lightness}"/>
							<Label HorizontalAlignment="Right" VerticalAlignment="Center" Grid.Column="0" Grid.Row="1" Margin="3,0,0,0">
								<TextBlock TextDecorations="Underline" Text="{x:Static prop:Resources.LightnessInitial}"/>
							</Label>
							<local:ColorComponentBox x:Name="lightnessEntry"
								AutomationProperties.Name="{x:Static prop:Resources.Lightness}" AutomationProperties.HelpText="{x:Static prop:Resources.Lightness}" ToolTip="{x:Static prop:Resources.Lightness}"
								HorizontalAlignment="Stretch" VerticalAlignment="Center" Grid.Column="1" Grid.Row="1"
								Value="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Lightness, Converter={local:DoubleToPercentageConverter}, Mode=TwoWay}" Unit="%"
								GradientBrush="{TemplateBinding Color, Converter={local:ColorComponentToLightnessBrushConverter}}"/>

							<Button HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Grid.Column="0" Grid.Row="2" Opacity="0" FocusVisualStyle="{x:Null}" Panel.ZIndex="1" IsTabStop="False"
								AutomationProperties.Name="{x:Static prop:Resources.Saturation}" AutomationProperties.HelpText="{x:Static prop:Resources.Saturation}" ToolTip="{x:Static prop:Resources.Saturation}"/>
							<Label HorizontalAlignment="Right" VerticalAlignment="Center" Grid.Column="0" Grid.Row="2" Margin="3,0,0,0">
								<TextBlock TextDecorations="Underline" Text="{x:Static prop:Resources.SaturationInitial}"/>
							</Label>
							<local:ColorComponentBox x:Name="saturationEntryHLS" HorizontalAlignment="Stretch" VerticalAlignment="Center" Grid.Column="1" Grid.Row="2"
								AutomationProperties.Name="{x:Static prop:Resources.Saturation}" AutomationProperties.HelpText="{x:Static prop:Resources.Saturation}" ToolTip="{x:Static prop:Resources.Saturation}"
								Value="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Saturation, Converter={local:DoubleToPercentageConverter}, Mode=TwoWay}" Unit="%"
								GradientBrush="{TemplateBinding Color, Converter={local:ColorComponentToSaturationBrushConverter}}"/>

							<Label Content="{x:Static prop:Resources.AlphaInitial}" HorizontalAlignment="Right" VerticalAlignment="Center" Grid.Column="0" Grid.Row="3"
								AutomationProperties.Name="{x:Static prop:Resources.Alpha}" AutomationProperties.HelpText="{x:Static prop:Resources.Alpha}" ToolTip="{x:Static prop:Resources.Alpha}"/>
							<local:ColorComponentBox x:Name="alphaEntryHLS" HorizontalAlignment="Stretch" VerticalAlignment="Center" Grid.Column="1" Grid.Row="3"
								AutomationProperties.Name="{x:Static prop:Resources.Alpha}" AutomationProperties.HelpText="{x:Static prop:Resources.Alpha}" ToolTip="{x:Static prop:Resources.Alpha}"
								Value="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=A, Converter={local:ByteToPercentageConverter}, Mode=TwoWay}" Unit="%"
								GradientBrush="{TemplateBinding Color, Converter={local:ColorComponentToAlphaBrushConverter}}"/>
						</Grid>
						
						<Grid x:Name="hsbPane" Visibility="Collapsed" Grid.Row="0" Grid.Column="0">
							<Grid.RowDefinitions>
								<RowDefinition Height="Auto" MinHeight="22"/>
								<RowDefinition Height="Auto" MinHeight="22"/>
								<RowDefinition Height="Auto" MinHeight="22"/>
								<RowDefinition Height="Auto" MinHeight="22"/>
							</Grid.RowDefinitions>
							<Grid.ColumnDefinitions>
								<ColumnDefinition Width="23"/>
								<ColumnDefinition Width="77"/>
							</Grid.ColumnDefinitions>

							<Button HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Grid.Column="0" Grid.Row="0" Opacity="0" FocusVisualStyle="{x:Null}" Panel.ZIndex="1" IsTabStop="False"
								AutomationProperties.Name="{x:Static prop:Resources.Hue}" AutomationProperties.HelpText="{x:Static prop:Resources.Hue}" ToolTip="{x:Static prop:Resources.Hue}"/>
							<Label HorizontalAlignment="Right" VerticalAlignment="Center" Grid.Column="0" Grid.Row="0" Margin="3,0,0,0">
								<TextBlock TextDecorations="Underline" Text="{x:Static prop:Resources.HueInitial}"/>
							</Label>
							<local:ColorComponentBox x:Name="hsbHueEntry" HorizontalAlignment="Stretch" VerticalAlignment="Center" Grid.Column="1" Grid.Row="0"
								AutomationProperties.Name="{x:Static prop:Resources.Hue}" AutomationProperties.HelpText="{x:Static prop:Resources.Hue}" ToolTip="{x:Static prop:Resources.Hue}"
								Value="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Hue, Mode=TwoWay}" Unit="°">
								<local:ColorComponentBox.GradientBrush>
									<LinearGradientBrush EndPoint="1,0" StartPoint="0,0">
										<GradientStop Color="Red" Offset="0"/>
										<GradientStop Color="Yellow" Offset="0.167"/>
										<GradientStop Color="Lime" Offset="0.333"/>
										<GradientStop Color="Cyan" Offset="0.500"/>
										<GradientStop Color="Blue" Offset="0.667"/>
										<GradientStop Color="Magenta" Offset="0.833"/>
										<GradientStop Color="Red" Offset="1"/>
									</LinearGradientBrush>
								</local:ColorComponentBox.GradientBrush>
							</local:ColorComponentBox>

							<Button HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Grid.Column="0" Grid.Row="1" Opacity="0" FocusVisualStyle="{x:Null}" Panel.ZIndex="1" IsTabStop="False"
								AutomationProperties.Name="{x:Static prop:Resources.Saturation}" AutomationProperties.HelpText="{x:Static prop:Resources.Saturation}" ToolTip="{x:Static prop:Resources.Saturation}"/>
							<Label HorizontalAlignment="Right" VerticalAlignment="Center" Grid.Column="0" Grid.Row="1" Margin="3,0,0,0">
								<TextBlock TextDecorations="Underline" Text="{x:Static prop:Resources.SaturationInitial}"/>
							</Label>
							<local:ColorComponentBox x:Name="saturationEntryHSB" HorizontalAlignment="Stretch" VerticalAlignment="Center" Grid.Column="1" Grid.Row="1"
								AutomationProperties.Name="{x:Static prop:Resources.Saturation}" AutomationProperties.HelpText="{x:Static prop:Resources.Saturation}" ToolTip="{x:Static prop:Resources.Saturation}"
								Value="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Saturation, Converter={local:DoubleToPercentageConverter}, Mode=TwoWay}" Unit="%"
								GradientBrush="{TemplateBinding Color, Converter={local:ColorComponentToSaturationBrushConverter}}"/>

							<Button HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Grid.Column="0" Grid.Row="2" Opacity="0" FocusVisualStyle="{x:Null}" Panel.ZIndex="1" IsTabStop="False"
								AutomationProperties.Name="{x:Static prop:Resources.Brightness}" AutomationProperties.HelpText="{x:Static prop:Resources.Brightness}" ToolTip="{x:Static prop:Resources.Brightness}"/>
							<Label HorizontalAlignment="Right" VerticalAlignment="Center" Grid.Column="0" Grid.Row="2" Margin="3,0,0,0">
								<TextBlock TextDecorations="Underline" Text="{x:Static prop:Resources.BrightnessInitial}"/>
							</Label>
							<local:ColorComponentBox x:Name="brightnessEntry" HorizontalAlignment="Stretch" VerticalAlignment="Center" Grid.Column="1" Grid.Row="2"
								AutomationProperties.Name="{x:Static prop:Resources.Brightness}" AutomationProperties.HelpText="{x:Static prop:Resources.Brightness}" ToolTip="{x:Static prop:Resources.Brightness}"
								Value="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Brightness, Converter={local:DoubleToPercentageConverter}, Mode=TwoWay}" Unit="%"
								GradientBrush="{TemplateBinding Color, Converter={local:ColorComponentToBrightnessBrushConverter}}"/>

							<Label Content="{x:Static prop:Resources.AlphaInitial}" HorizontalAlignment="Right" VerticalAlignment="Center" Grid.Column="0" Grid.Row="3"
								AutomationProperties.Name="{x:Static prop:Resources.Alpha}" AutomationProperties.HelpText="{x:Static prop:Resources.Alpha}" ToolTip="{x:Static prop:Resources.Alpha}"/>
							<local:ColorComponentBox x:Name="alphaEntryHSB" HorizontalAlignment="Stretch" VerticalAlignment="Center" Grid.Column="1" Grid.Row="3"
								AutomationProperties.Name="{x:Static prop:Resources.Alpha}" AutomationProperties.HelpText="{x:Static prop:Resources.Alpha}" ToolTip="{x:Static prop:Resources.Alpha}"
								Value="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=A, Converter={local:ByteToPercentageConverter}, Mode=TwoWay}" Unit="%"
								GradientBrush="{TemplateBinding Color, Converter={local:ColorComponentToAlphaBrushConverter}}"/>
						</Grid>
						
						<Grid x:Name="rgbPane" Grid.Row="0" Grid.Column="0">
							<Grid.RowDefinitions>
								<RowDefinition Height="Auto" MinHeight="22"/>
								<RowDefinition Height="Auto" MinHeight="22"/>
								<RowDefinition Height="Auto" MinHeight="22"/>
								<RowDefinition Height="Auto" MinHeight="22"/>
							</Grid.RowDefinitions>
							<Grid.ColumnDefinitions>
								<ColumnDefinition Width="23"/>
								<ColumnDefinition Width="77"/>
							</Grid.ColumnDefinitions>

							<Button HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Grid.Column="0" Grid.Row="0" Opacity="0" FocusVisualStyle="{x:Null}" Panel.ZIndex="1" IsTabStop="False"
								AutomationProperties.Name="{x:Static prop:Resources.Red}" AutomationProperties.HelpText="{x:Static prop:Resources.Red}" ToolTip="{x:Static prop:Resources.Red}"/>
							<Label HorizontalAlignment="Right" VerticalAlignment="Center" Grid.Column="0" Grid.Row="0" Margin="3,0,0,0">
								<TextBlock TextDecorations="Underline" Text="{x:Static prop:Resources.RedInitial}"/>
							</Label>
							<local:ColorComponentBox x:Name="redEntry" HorizontalAlignment="Stretch" VerticalAlignment="Center" Grid.Column="1" Grid.Row="0"
								AutomationProperties.Name="{x:Static prop:Resources.Red}" AutomationProperties.HelpText="{x:Static prop:Resources.Red}" ToolTip="{x:Static prop:Resources.Red}"
								Value="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=R, Mode=TwoWay}"
								GradientBrush="{TemplateBinding Color, Converter={local:ColorComponentToRedBrushConverter}}"/>

							<Button HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Grid.Column="0" Grid.Row="1" Opacity="0" FocusVisualStyle="{x:Null}" Panel.ZIndex="1" IsTabStop="False"
								AutomationProperties.Name="{x:Static prop:Resources.Green}" AutomationProperties.HelpText="{x:Static prop:Resources.Green}" ToolTip="{x:Static prop:Resources.Green}"/>
							<Label HorizontalAlignment="Right" VerticalAlignment="Center" Grid.Column="0" Grid.Row="1" Margin="3,0,0,0">
								<TextBlock TextDecorations="Underline" Text="{x:Static prop:Resources.GreenInitial}"/>
							</Label>
							<local:ColorComponentBox x:Name="greenEntry" HorizontalAlignment="Stretch" VerticalAlignment="Center" Grid.Column="1" Grid.Row="1"
								AutomationProperties.Name="{x:Static prop:Resources.Green}" AutomationProperties.HelpText="{x:Static prop:Resources.Green}" ToolTip="{x:Static prop:Resources.Green}"
								Value="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=G, Mode=TwoWay}"
								GradientBrush="{TemplateBinding Color, Converter={local:ColorComponentToGreenBrushConverter}}"/>

							<Button HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Grid.Column="0" Grid.Row="2" Opacity="0" FocusVisualStyle="{x:Null}" Panel.ZIndex="1" IsTabStop="False"
								AutomationProperties.Name="{x:Static prop:Resources.Blue}" AutomationProperties.HelpText="{x:Static prop:Resources.Blue}" ToolTip="{x:Static prop:Resources.Blue}"/>
							<Label HorizontalAlignment="Right" VerticalAlignment="Center" Grid.Column="0" Grid.Row="2" Margin="3,0,0,0">
								<TextBlock TextDecorations="Underline" Text="{x:Static prop:Resources.BlueInitial}"/>
							</Label>
							<local:ColorComponentBox x:Name="blueEntry" HorizontalAlignment="Stretch" VerticalAlignment="Center" Grid.Column="1" Grid.Row="2"
								AutomationProperties.Name="{x:Static prop:Resources.Blue}" AutomationProperties.HelpText="{x:Static prop:Resources.Blue}" ToolTip="{x:Static prop:Resources.Blue}"
								Value="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=B, Mode=TwoWay}"
								GradientBrush="{TemplateBinding Color, Converter={local:ColorComponentToBlueBrushConverter}}"/>

							<Label Content="{x:Static prop:Resources.AlphaInitial}" HorizontalAlignment="Right" VerticalAlignment="Center" Grid.Column="0" Grid.Row="3"
								AutomationProperties.Name="{x:Static prop:Resources.Alpha}" AutomationProperties.HelpText="{x:Static prop:Resources.Alpha}" ToolTip="{x:Static prop:Resources.Alpha}"/>
							<local:ColorComponentBox x:Name="alphaEntryRGB" HorizontalAlignment="Stretch" VerticalAlignment="Center" Grid.Column="1" Grid.Row="3"
								AutomationProperties.Name="{x:Static prop:Resources.Alpha}" AutomationProperties.HelpText="{x:Static prop:Resources.Alpha}" ToolTip="{x:Static prop:Resources.Alpha}"
								Value="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=A, Converter={local:ByteToPercentageConverter}, Mode=TwoWay}" Unit="%"
								GradientBrush="{TemplateBinding Color, Converter={local:ColorComponentToAlphaBrushConverter}}"/>
						</Grid>
						
						<Grid x:Name="cmykPane" Visibility="Collapsed" Grid.Row="0" Grid.Column="0">
							<Grid.RowDefinitions>
								<RowDefinition Height="Auto" MinHeight="22"/>
								<RowDefinition Height="Auto" MinHeight="22"/>
								<RowDefinition Height="Auto" MinHeight="22"/>
								<RowDefinition Height="Auto" MinHeight="22"/>
								<RowDefinition Height="Auto" MinHeight="22"/>
							</Grid.RowDefinitions>
							<Grid.ColumnDefinitions>
								<ColumnDefinition Width="23"/>
								<ColumnDefinition Width="77"/>
							</Grid.ColumnDefinitions>

							<Button HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Grid.Column="0" Grid.Row="0" Opacity="0" FocusVisualStyle="{x:Null}" Panel.ZIndex="1" IsTabStop="False"
								AutomationProperties.Name="{x:Static prop:Resources.Cyan}" AutomationProperties.HelpText="{x:Static prop:Resources.Cyan}" ToolTip="{x:Static prop:Resources.Cyan}"/>
							<Label HorizontalAlignment="Right" VerticalAlignment="Center" Grid.Column="0" Grid.Row="0" Margin="3,0,0,0">
								<TextBlock TextDecorations="Underline" Text="{x:Static prop:Resources.CyanInitial}"/>
							</Label>
							<local:ColorComponentBox x:Name="cyanEntry" HorizontalAlignment="Stretch" VerticalAlignment="Center" Grid.Column="1" Grid.Row="0"
								AutomationProperties.Name="{x:Static prop:Resources.Cyan}" AutomationProperties.HelpText="{x:Static prop:Resources.Cyan}" ToolTip="{x:Static prop:Resources.Cyan}"
								Value="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=C, Converter={local:DoubleToPercentageConverter}, Mode=TwoWay}" Unit="%"
								GradientBrush="{TemplateBinding Color, Converter={local:ColorComponentToCyanBrushConverter}}"/>

							<Button HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Grid.Column="0" Grid.Row="1" Opacity="0" FocusVisualStyle="{x:Null}" Panel.ZIndex="1" IsTabStop="False"
								AutomationProperties.Name="{x:Static prop:Resources.Magenta}" AutomationProperties.HelpText="{x:Static prop:Resources.Magenta}" ToolTip="{x:Static prop:Resources.Magenta}"/>
							<Label HorizontalAlignment="Right" VerticalAlignment="Center" Grid.Column="0" Grid.Row="1" Margin="3,0,0,0">
								<TextBlock TextDecorations="Underline" Text="{x:Static prop:Resources.MagentaInitial}"/>
							</Label>
							<local:ColorComponentBox x:Name="magentaEntry" HorizontalAlignment="Stretch" VerticalAlignment="Center" Grid.Column="1" Grid.Row="1"
								AutomationProperties.Name="{x:Static prop:Resources.Magenta}" AutomationProperties.HelpText="{x:Static prop:Resources.Magenta}" ToolTip="{x:Static prop:Resources.Magenta}"
								Value="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=M, Converter={local:DoubleToPercentageConverter}, Mode=TwoWay}" Unit="%"
								GradientBrush="{TemplateBinding Color, Converter={local:ColorComponentToMagentaBrushConverter}}"/>

							<Button HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Grid.Column="0" Grid.Row="2" Opacity="0" FocusVisualStyle="{x:Null}" Panel.ZIndex="1" IsTabStop="False"
								AutomationProperties.Name="{x:Static prop:Resources.Yellow}" AutomationProperties.HelpText="{x:Static prop:Resources.Yellow}" ToolTip="{x:Static prop:Resources.Yellow}"/>
							<Label HorizontalAlignment="Right" VerticalAlignment="Center" Grid.Column="0" Grid.Row="2" Margin="3,0,0,0">
								<TextBlock TextDecorations="Underline" Text="{x:Static prop:Resources.YellowInitial}"/>
							</Label>
							<local:ColorComponentBox x:Name="yellowEntry" HorizontalAlignment="Stretch" VerticalAlignment="Center" Grid.Column="1" Grid.Row="2"
								AutomationProperties.Name="{x:Static prop:Resources.Yellow}" AutomationProperties.HelpText="{x:Static prop:Resources.Yellow}" ToolTip="{x:Static prop:Resources.Yellow}"
								Value="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Y, Converter={local:DoubleToPercentageConverter}, Mode=TwoWay}" Unit="%"
								GradientBrush="{TemplateBinding Color, Converter={local:ColorComponentToYellowBrushConverter}}"/>

							<Button HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Grid.Column="0" Grid.Row="3" Opacity="0" FocusVisualStyle="{x:Null}" Panel.ZIndex="1" IsTabStop="False"
								AutomationProperties.Name="{x:Static prop:Resources.Black}" AutomationProperties.HelpText="{x:Static prop:Resources.Black}" ToolTip="{x:Static prop:Resources.Black}"/>
							<Label HorizontalAlignment="Right" VerticalAlignment="Center" Grid.Column="0" Grid.Row="3" Margin="3,0,0,0">
								<TextBlock TextDecorations="Underline" Text="{x:Static prop:Resources.BlackInitial}"/>
							</Label>
							<local:ColorComponentBox x:Name="blackEntry" HorizontalAlignment="Stretch" VerticalAlignment="Center" Grid.Column="1" Grid.Row="3"
								AutomationProperties.Name="{x:Static prop:Resources.Black}" AutomationProperties.HelpText="{x:Static prop:Resources.Black}" ToolTip="{x:Static prop:Resources.Black}"
								Value="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=K, Converter={local:DoubleToPercentageConverter}, Mode=TwoWay}" Unit="%"
								GradientBrush="{TemplateBinding Color, Converter={local:ColorComponentToBlackBrushConverter}}"/>

							<Label Content="{x:Static prop:Resources.AlphaInitial}" HorizontalAlignment="Right" VerticalAlignment="Center" Grid.Column="0" Grid.Row="4"
								AutomationProperties.Name="{x:Static prop:Resources.Alpha}" AutomationProperties.HelpText="{x:Static prop:Resources.Alpha}" ToolTip="{x:Static prop:Resources.Alpha}"/>
							<local:ColorComponentBox x:Name="alphaEntryCMYK" HorizontalAlignment="Stretch" VerticalAlignment="Center" Grid.Column="1" Grid.Row="4"
								AutomationProperties.Name="{x:Static prop:Resources.Alpha}" AutomationProperties.HelpText="{x:Static prop:Resources.Alpha}" ToolTip="{x:Static prop:Resources.Alpha}"
								Value="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=A, Converter={local:ByteToPercentageConverter}, Mode=TwoWay}" Unit="%"
								GradientBrush="{TemplateBinding Color, Converter={local:ColorComponentToAlphaBrushConverter}}"/>
						</Grid>
						
						<local:TextBoxEx x:Name="hexEntry" HorizontalContentAlignment="Left" HorizontalAlignment="Right" VerticalAlignment="Bottom" Width="77" Grid.Column="0" Grid.Row="2"
							AutomationProperties.Name="{x:Static prop:Resources.HexValue}" AutomationProperties.HelpText="{x:Static prop:Resources.HexValue}" ToolTip="{x:Static prop:Resources.HexValue}"
							Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Color, Converter={local:HexColorConverter}, Mode=TwoWay}" FocusSelectsAll="True"/>
					</Grid>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>

	<Style TargetType="local:ColorComponentBox">
		<Setter Property="KeyboardNavigation.TabNavigation" Value="Continue"/>
		<Setter Property="IsTabStop" Value="False"/>
		<Setter Property="FocusVisualStyle" Value="{x:Null}"/>
		<Setter Property="Template">
			<Setter.Value>
				<ControlTemplate TargetType="local:ColorComponentBox">
					<Grid>
						<local:TextBoxEx x:Name="innerTextBox" FocusSelectsAll="True" VerticalContentAlignment="Center"
								 BitmapEffect="{TemplateBinding BitmapEffect}" BitmapEffectInput="{TemplateBinding BitmapEffectInput}"
								 CacheMode="{TemplateBinding CacheMode}" Clip="{TemplateBinding Clip}" ClipToBounds="{TemplateBinding ClipToBounds}" ContextMenu="{TemplateBinding ContextMenu}"
								 Cursor="{TemplateBinding Cursor}" DataContext="{TemplateBinding DataContext}" FlowDirection="{TemplateBinding FlowDirection}"
								 Focusable="True" FocusVisualStyle="{TemplateBinding FocusVisualStyle}" FontFamily="{TemplateBinding FontFamily}"
								 FontSize="{TemplateBinding FontSize}" FontStretch="{TemplateBinding FontStretch}" FontStyle="{TemplateBinding FontStyle}" FontWeight="{TemplateBinding FontWeight}" ForceCursor="{TemplateBinding ForceCursor}"
								 Height="{TemplateBinding Height}" HorizontalAlignment="{TemplateBinding HorizontalAlignment}" HorizontalContentAlignment="{TemplateBinding HorizontalContentAlignment}"
								 IsHitTestVisible="{TemplateBinding IsHitTestVisible}" IsEnabled="{TemplateBinding IsEnabled}" IsManipulationEnabled="{TemplateBinding IsManipulationEnabled}"
								 IsTabStop="True" IsUndoEnabled="True" Margin="{TemplateBinding Margin}" MaxHeight="{TemplateBinding MaxHeight}" MaxWidth="{TemplateBinding MaxWidth}" MinHeight="{TemplateBinding MinHeight}"
								 MinWidth="{TemplateBinding MinWidth}" Padding="{TemplateBinding Padding}" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" ToolTip="{TemplateBinding ToolTip}" TabIndex="{TemplateBinding TabIndex}"
								 Tag="{TemplateBinding Tag}" UseLayoutRounding="{TemplateBinding UseLayoutRounding}" Uid="{TemplateBinding Uid}" Grid.Row="0" Grid.Column="0" Panel.ZIndex="0"
								 AutomationProperties.Name="{TemplateBinding AutomationProperties.Name}" AutomationProperties.HelpText="{TemplateBinding AutomationProperties.Name}">
							<TextBox.Text>
								<MultiBinding Converter="{local:DoubleToQuantityConverter}">
									<Binding Path="Value" RelativeSource="{RelativeSource TemplatedParent}"/>
									<Binding Path="Unit" RelativeSource="{RelativeSource TemplatedParent}"/>
								</MultiBinding>
							</TextBox.Text>
						</local:TextBoxEx>
						<local:BrushBoxControl x:Name="brushBoxControl" Visibility="Visible"
							Brush="{Binding Path=GradientBrush, RelativeSource={RelativeSource TemplatedParent}}"
							Height="3" HorizontalAlignment="Stretch" VerticalAlignment="Bottom"
							Grid.Row="0" Grid.Column="0" Panel.ZIndex="1"/>
					</Grid>
					<ControlTemplate.Triggers>
						<DataTrigger Binding="{Binding IsKeyboardFocusWithin, ElementName=innerTextBox}" Value="True">
							<Setter TargetName="innerTextBox" Property="Text" Value="{Binding Path=Value, RelativeSource={RelativeSource TemplatedParent}, Mode=TwoWay, StringFormat={}{0:##0.#}}"/>
							<Setter TargetName="brushBoxControl" Property="Visibility" Value="Hidden"/>
						</DataTrigger>
						<DataTrigger Binding="{Binding IsFocused, ElementName=innerTextBox}" Value="True">
							<Setter TargetName="innerTextBox" Property="Text" Value="{Binding Path=Value, RelativeSource={RelativeSource TemplatedParent}, Mode=TwoWay, StringFormat={}{0:##0.#}}"/>
						</DataTrigger>
						<Trigger Property="GradientBrush" Value="{x:Null}">
							<Setter Property="Visibility" TargetName="brushBoxControl" Value="Hidden"/>
						</Trigger>
					</ControlTemplate.Triggers>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>

	<Style TargetType="local:CurrentColorEditorControl">
		<Setter Property="IsTabStop" Value="False"/>
		<Setter Property="Template">
			<Setter.Value>
				<ControlTemplate TargetType="local:CurrentColorEditorControl">
					<Grid>
						<Grid.ColumnDefinitions>
							<ColumnDefinition Width="*"/>
							<ColumnDefinition Width="*"/>
							<ColumnDefinition Width="20"/>
						</Grid.ColumnDefinitions>
						<local:BrushBoxControl HorizontalAlignment="Stretch" Grid.Column="0" Panel.ZIndex="0" IsTabStop="False">
							<local:BrushBoxControl.Brush>
								<SolidColorBrush Color="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=InitialColor, Converter={local:CommonColorToColorConverter}}"/>
							</local:BrushBoxControl.Brush>
						</local:BrushBoxControl>
						<Button x:Name="initialColorButton" HorizontalAlignment="Stretch" Grid.Column="0" Panel.ZIndex="1" Opacity="0" FocusVisualStyle="{x:Null}" IsTabStop="False"
								AutomationProperties.Name="{x:Static prop:Resources.InitialColor}" AutomationProperties.HelpText="{x:Static prop:Resources.InitialColor}" ToolTip="{x:Static prop:Resources.InitialColor}"/>
						<local:BrushBoxControl HorizontalAlignment="Stretch" Grid.Column="1" IsTabStop="False"
											   AutomationProperties.Name="{x:Static prop:Resources.CurrentColor}" AutomationProperties.HelpText="{x:Static prop:Resources.CurrentColor}" ToolTip="{x:Static prop:Resources.CurrentColor}">
							<local:BrushBoxControl.Brush>
								<SolidColorBrush Color="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Color, Converter={local:CommonColorToColorConverter}}"/>
							</local:BrushBoxControl.Brush>
						</local:BrushBoxControl>
						<local:BrushBoxControl HorizontalAlignment="Stretch" Grid.Column="2" Margin="1,0,0,0" IsTabStop="False"
											   AutomationProperties.Name="{x:Static prop:Resources.LastColor}" AutomationProperties.HelpText="{x:Static prop:Resources.LastColor}" ToolTip="{x:Static prop:Resources.LastColor}">
							<local:BrushBoxControl.Brush>
								<SolidColorBrush Color="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=LastColor, Converter={local:CommonColorToColorConverter}}"/>
							</local:BrushBoxControl.Brush>
						</local:BrushBoxControl>
					</Grid>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>

	<Style x:Key="MaterialDesignColorControlItem" BasedOn="{StaticResource {x:Type RadioButton}}" TargetType="RadioButton">
		<Setter Property="Background" Value="{DynamicResource ToggleItemBackgroundBrush}" />
		<Setter Property="Template">
			<Setter.Value>
				<ControlTemplate TargetType="RadioButton">
					<Border Name="ButtonBorder" Background="{TemplateBinding Background}" Padding="{TemplateBinding Padding}"
							BorderBrush="{TemplateBinding Background}" BorderThickness="{TemplateBinding BorderThickness}">
						<ContentPresenter />
					</Border>
					<ControlTemplate.Triggers>
						<Trigger Property="IsChecked" Value="True">
							<Setter Property="BorderBrush" TargetName="ButtonBorder" Value="{DynamicResource ToggleItemSelectedBorderBrush}"/>
							<Setter Property="Padding" TargetName="ButtonBorder" Value="1"/>
							<Setter Property="BorderThickness" TargetName="ButtonBorder" Value="1"/>
						</Trigger>
						<Trigger Property="IsMouseOver" Value="True">
							<Setter Property="BorderBrush" TargetName="ButtonBorder" Value="{DynamicResource ToggleItemMouseOverBorderBrush}" />
							<Setter Property="Padding" TargetName="ButtonBorder" Value="1"/>
							<Setter Property="BorderThickness" TargetName="ButtonBorder" Value="1"/>
							<Setter Property="Background" TargetName="ButtonBorder" Value="{DynamicResource ToggleItemMouseOverBackgroundBrush}"/>
						</Trigger>
						<Trigger Property="IsPressed" Value="True">
							<Setter Property="BorderBrush" TargetName="ButtonBorder" Value="{DynamicResource ToggleItemPressedBorderBrush}" />
							<Setter Property="Padding" TargetName="ButtonBorder" Value="1"/>
							<Setter Property="BorderThickness" TargetName="ButtonBorder" Value="1"/>
							<Setter Property="Background" TargetName="ButtonBorder" Value="{DynamicResource ToggleItemPressedBackgroundBrush}"/>
						</Trigger>
					</ControlTemplate.Triggers>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>

	<SolidColorBrush x:Key="DarkeningBrush" Color="#40000000"/>

	<Style TargetType="local:MaterialDesignColorEditorControl">
		<Setter Property="Template">
			<Setter.Value>
				<ControlTemplate TargetType="local:MaterialDesignColorEditorControl">
					<Border BorderThickness="0" Padding="2,0,2,0" DataContext="{Binding MaterialDesign}">
						<StackPanel Orientation="Vertical">
							<Grid Margin="0,2,0,2"  Background="Transparent">
								<local:ChoiceControl x:Name="palettePicker" Background="Transparent"
									Grid.Column="0" Grid.Row="0" Panel.ZIndex="0" BorderThickness="0"
									ItemsSource="{Binding Palettes}"
									SelectedValue="{Binding ColorName}"
									SelectedValuePath="Name">
									<local:ChoiceControl.ItemTemplate>
										<DataTemplate>
											<RadioButton Style="{DynamicResource MaterialDesignColorControlItem}"
												ToolTip="{Binding Name}" AutomationProperties.Name="{Binding Name}" AutomationProperties.HelpText="{Binding Name}"
												GroupName="{Binding Name, RelativeSource={RelativeSource FindAncestor,AncestorType=local:ChoiceControl}, Mode=OneTime}">
												<Grid Margin="0">
													<local:BrushBoxControl>
														<local:BrushBoxControl.Brush>
															<SolidColorBrush Color="{Binding MainColor, Converter={local:CommonColorToColorConverter}}"/>
														</local:BrushBoxControl.Brush>
													</local:BrushBoxControl>
													<Border BorderBrush="{StaticResource DarkeningBrush}" BorderThickness="1" Grid.Column="0" Grid.Row="0" Panel.ZIndex="1"/>
												</Grid>
											</RadioButton>
										</DataTemplate>
									</local:ChoiceControl.ItemTemplate>
									<local:ChoiceControl.ItemsPanel>
										<ItemsPanelTemplate>
											<UniformGrid Columns="10" UseLayoutRounding="False"/>
										</ItemsPanelTemplate>
									</local:ChoiceControl.ItemsPanel>
								</local:ChoiceControl>
							</Grid>
							<TextBlock Name="colorLabel" Text="{Binding ColorName}" FontWeight="Bold"/>
							<Grid Margin="0,2,0,2">
								<local:ChoiceControl x:Name="normalColorPicker" Background="Transparent"
									Grid.Column="0" Grid.Row="0" Panel.ZIndex="0" BorderThickness="0"
									ItemsSource="{Binding NormalColorScale}"
									SelectedValue="{Binding NormalColor}" SelectedValuePath="">
									<local:ChoiceControl.ItemTemplate>
										<DataTemplate>
											<RadioButton Style="{DynamicResource MaterialDesignColorControlItem}"
												BorderThickness="0"
												ToolTip="{Binding Label}" AutomationProperties.Name="{Binding Label}" AutomationProperties.HelpText="{Binding Label}"
												GroupName="MaterialDesignAccentOrNormal">
												<local:BrushBoxControl Label="{Binding Label}" FontSize="10"
																	   LightForegroundThreshold="{Binding Path=DataContext.NormalColorScriptureLightnessThreshold, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:ChoiceControl}}}">
													<local:BrushBoxControl.Brush>
														<SolidColorBrush Color="{Binding Converter={local:CommonColorToColorConverter}}"/>
													</local:BrushBoxControl.Brush>
												</local:BrushBoxControl>
											</RadioButton>
										</DataTemplate>
									</local:ChoiceControl.ItemTemplate>
									<local:ChoiceControl.ItemsPanel>
										<ItemsPanelTemplate>
											<UniformGrid Columns="{Binding NormalColorScale.Count}" Height="25" UseLayoutRounding="False"/>
										</ItemsPanelTemplate>
									</local:ChoiceControl.ItemsPanel>
								</local:ChoiceControl>
								<Border BorderBrush="{StaticResource DarkeningBrush}" BorderThickness="1" Grid.Column="0" Grid.Row="0" Panel.ZIndex="1"/>
							</Grid>
							<Grid Margin="0,2,0,2" Visibility="{Binding AccentColorScale, Converter={local:HasItemsToVisibilityConverter}}">
								<local:ChoiceControl x:Name="accentColorPicker" Background="Transparent"
									Grid.Column="0" Grid.Row="0" Panel.ZIndex="0" BorderThickness="0"
									ItemsSource="{Binding AccentColorScale}"
									SelectedValue="{Binding AccentColor}" SelectedValuePath="">
									<local:ChoiceControl.ItemTemplate>
										<DataTemplate>
											<RadioButton Style="{DynamicResource MaterialDesignColorControlItem}"
												BorderThickness="0"
												ToolTip="{Binding Label}" AutomationProperties.Name="{Binding Label}" AutomationProperties.HelpText="{Binding Label}"
												GroupName="MaterialDesignAccentOrNormal">
												<local:BrushBoxControl Label="{Binding Label}" FontSize="10"
																	   LightForegroundThreshold="{Binding Path=DataContext.AccentColorScriptureLightnessThreshold, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type local:ChoiceControl}}}">
													<local:BrushBoxControl.Brush>
														<SolidColorBrush Color="{Binding Converter={local:CommonColorToColorConverter}}"/>
													</local:BrushBoxControl.Brush>
												</local:BrushBoxControl>
											</RadioButton>
										</DataTemplate>
									</local:ChoiceControl.ItemTemplate>
									<local:ChoiceControl.ItemsPanel>
										<ItemsPanelTemplate>
											<UniformGrid Columns="{Binding AccentColorScale.Count}" Height="25" UseLayoutRounding="False"/>
										</ItemsPanelTemplate>
									</local:ChoiceControl.ItemsPanel>
								</local:ChoiceControl>
								<Border BorderBrush="{StaticResource DarkeningBrush}" BorderThickness="1" Grid.Column="0" Grid.Row="0" Panel.ZIndex="1"/>
							</Grid>
							<local:PropertyPresenter x:Name="alpha" Label="{x:Static prop:Resources.Alpha}" ShowPropertyButton="False"
								AutomationProperties.Name="{x:Static prop:Resources.Alpha}" AutomationProperties.HelpText="{x:Static prop:Resources.Alpha}" ToolTip="{x:Static prop:Resources.Alpha}">
								<local:ColorComponentBox x:Name="alphaEntry" HorizontalAlignment="Stretch" VerticalAlignment="Center"
									AutomationProperties.Name="{x:Static prop:Resources.Alpha}" AutomationProperties.HelpText="{x:Static prop:Resources.Alpha}" ToolTip="{x:Static prop:Resources.Alpha}"
									Value="{Binding Alpha, Converter={local:ByteToPercentageConverter}, Mode=TwoWay}" Unit="%"/>
							</local:PropertyPresenter>
						</StackPanel>
					</Border>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>

	<Style TargetType="local:ImageBrushEditorControl">
		<Setter Property="Template">
			<Setter.Value>
				<ControlTemplate TargetType="local:ImageBrushEditorControl">
					<Border BorderThickness="0" Padding="0,2,0,2">
						<Grid>
							<Grid.ColumnDefinitions>
								<ColumnDefinition Width="Auto"/>
								<ColumnDefinition Width="*"/>
							</Grid.ColumnDefinitions>
							<Border Name="TilePreview" Width="102" Height="77" BorderBrush="{DynamicResource ControlBorderBrush}" BorderThickness="1" VerticalAlignment="Top" Grid.Column="0">
								<Canvas Background="{DynamicResource CheckerBoard}" Width="100" Height="75">
									<Rectangle Name="Brush" Width="100" Height="75">
										<Rectangle.Fill>
											<ImageBrush ImageSource="{Binding Value.ImageSource, Converter={local:CommonImageSourceToImageSourceConverter}}"
														Stretch="{Binding Value.Stretch, Converter={local:CommonStretchToStretchConverter}}"
														TileMode="{Binding Value.TileMode, Converter={local:CommonTileModeToTileModeConverter}}"
														AlignmentX="Center" AlignmentY="Center" Viewport="0.2,0.2,0.6,0.6" ViewportUnits="RelativeToBoundingBox"/>
										</Rectangle.Fill>
									</Rectangle>
									<Path Name="Mask" Fill="#80FFFFFF" Data="M0,0L100,0 100,75 0,75z M20,15L80,15 80,60 20,60z"/>
									<Path Name="Outline" Stroke="#FFFF0000" StrokeDashArray="5 5" StrokeDashOffset="2.5" StrokeThickness="1" Data="M20,0L20,75 M80,0L80,75 M0,15L100,15 M0,60L100,60"/>
								</Canvas>
							</Border>
							<Border BorderThickness="0" Padding="5,0,0,0" VerticalAlignment="Top" Grid.Column="1">
								<StackPanel Orientation="Vertical">
									<Label Content="{x:Static prop:Resources.TileMode}" HorizontalAlignment="Left" VerticalAlignment="Center" Padding="0" Margin="0,0,0,3"
										   AutomationProperties.Name="{x:Static prop:Resources.TileMode}" AutomationProperties.HelpText="{x:Static prop:Resources.TileMode}" ToolTip="{x:Static prop:Resources.TileMode}"/>
									<ComboBox x:Name="TileModeComboBox" ItemsSource="{Binding Image.TileModeValues, Mode=OneTime}" SelectedValue="{Binding Image.TileMode}" SelectedValuePath="Key" DisplayMemberPath="Value"
											  IsEditable="False" VerticalContentAlignment="Center" AutomationProperties.Name="{x:Static prop:Resources.TileMode}" Margin="0,0,0,8" />
									<Label Content="{x:Static prop:Resources.Stretch}" HorizontalAlignment="Left" VerticalAlignment="Center" Padding="0" Margin="0,0,3,0"
										   AutomationProperties.Name="{x:Static prop:Resources.Stretch}" AutomationProperties.HelpText="{x:Static prop:Resources.Stretch}" ToolTip="{x:Static prop:Resources.Stretch}"/>
									<ComboBox x:Name="StretchComboBox" ItemsSource="{Binding Image.StretchValues, Mode=OneTime}" SelectedValue="{Binding Image.Stretch}" SelectedValuePath="Key" DisplayMemberPath="Value"
											  IsEditable="False" VerticalContentAlignment="Center" AutomationProperties.Name="{x:Static prop:Resources.Stretch}" Margin="0,0,0,8" />
									<Label Content="{x:Static prop:Resources.ImageSource}" HorizontalAlignment="Left" VerticalAlignment="Center" Padding="0" Margin="0,0,0,3"
										   AutomationProperties.Name="{x:Static prop:Resources.ImageSource}" AutomationProperties.HelpText="{x:Static prop:Resources.ImageSource}" ToolTip="{x:Static prop:Resources.ImageSource}"/>
									<ComboBox x:Name="ImageSourceComboBox" ItemsSource="{Binding Image.ImageSources, Mode=OneTime}" SelectedValue="{Binding Image.ImageSource}" SelectedValuePath="Key" DisplayMemberPath="Value"
											  IsEditable="True" VerticalContentAlignment="Center" AutomationProperties.Name="{x:Static prop:Resources.ImageSource}" Margin="0,0,0,8" />
								</StackPanel>
							</Border>
						</Grid>
					</Border>
					<ControlTemplate.Triggers>
						<Trigger SourceName="TilePreview" Property="IsMouseOver" Value="True">
							<Setter TargetName="Mask" Property="Visibility" Value="Hidden"/>
							<Setter TargetName="Outline" Property="Visibility" Value="Hidden"/>
						</Trigger>
					</ControlTemplate.Triggers>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>

	<Style TargetType="local:BrushBoxControl">
		<Setter Property="IsTabStop" Value="False"/>
		<Setter Property="Template">
			<Setter.Value>
				<ControlTemplate TargetType="local:BrushBoxControl">
					<Grid>
						<Label HorizontalAlignment="Stretch" VerticalAlignment="Center" HorizontalContentAlignment="Center" VerticalContentAlignment="Center"
							   Content="{x:Static prop:Resources.NoBrush}" Visibility="{TemplateBinding NoBrushVisible}"
							   BorderThickness="{Binding BorderThickness, RelativeSource={RelativeSource TemplatedParent}}" BorderBrush="{Binding BorderBrush, RelativeSource={RelativeSource TemplatedParent}}"
							   Grid.Column="0" Grid.Row="0" Height="{Binding Height, RelativeSource={RelativeSource TemplatedParent}}" Padding="0"/>
						<Rectangle HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
								   Stroke="{Binding BorderBrush, RelativeSource={RelativeSource TemplatedParent}}" StrokeThickness="1"
								   Grid.Column="0" Grid.Row="0" Panel.ZIndex="0" Visibility="{Binding BrushVisible, RelativeSource={RelativeSource TemplatedParent}}"
								   Fill="{StaticResource CheckerBoard}" Height="{Binding Height, RelativeSource={RelativeSource TemplatedParent}}"/>
						<Rectangle HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Grid.Column="0" Grid.Row="0" Panel.ZIndex="1"
								   Stroke="{Binding BorderBrush, RelativeSource={RelativeSource TemplatedParent}}" StrokeThickness="1"
								   Fill="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Brush}" Visibility="{TemplateBinding BrushVisible}"
								   Height="{Binding Height, RelativeSource={RelativeSource TemplatedParent}}"/>
						<TextBlock Name="labelOutline" HorizontalAlignment="Center"  VerticalAlignment="Bottom"
								   Text="{Binding Label, RelativeSource={RelativeSource TemplatedParent}}"
								   Foreground="Transparent"
								   Grid.Column="0" Grid.Row="0" Panel.ZIndex="2" Visibility="{Binding BrushVisible, RelativeSource={RelativeSource TemplatedParent}}"
								   Height="{Binding Height, RelativeSource={RelativeSource TemplatedParent}}">
							<TextBlock.Effect>
								<BlurEffect Radius="3"/>
							</TextBlock.Effect>
						</TextBlock>
						<TextBlock Name="label" HorizontalAlignment="Center"  VerticalAlignment="Bottom"
								   Text="{Binding Label, RelativeSource={RelativeSource TemplatedParent}}"
								   Grid.Column="0" Grid.Row="0" Panel.ZIndex="3" Visibility="{Binding BrushVisible, RelativeSource={RelativeSource TemplatedParent}}"
								   Height="{Binding Height, RelativeSource={RelativeSource TemplatedParent}}"/>
					</Grid>
					<ControlTemplate.Triggers>
						<DataTrigger Value="Dark">
							<DataTrigger.Binding>
								<MultiBinding Converter="{local:BrushToDarknessConverter}">
									<Binding Path="Brush" RelativeSource="{RelativeSource Self}"/>
									<Binding Path="LightForegroundThreshold" RelativeSource="{RelativeSource Self}"/>
								</MultiBinding>
							</DataTrigger.Binding>
							<Setter TargetName="label" Property="Foreground" Value="#FFFFFFFF"/>
							<Setter TargetName="labelOutline" Property="Foreground" Value="Transparent"/>
						</DataTrigger>
						<DataTrigger Value="Light">
							<DataTrigger.Binding>
								<MultiBinding Converter="{local:BrushToDarknessConverter}">
									<Binding Path="Brush" RelativeSource="{RelativeSource Self}"/>
									<Binding Path="LightForegroundThreshold" RelativeSource="{RelativeSource Self}"/>
								</MultiBinding>
							</DataTrigger.Binding>
							<Setter TargetName="label" Property="Foreground" Value="#FF000000"/>
							<Setter TargetName="labelOutline" Property="Foreground" Value="Transparent"/>
						</DataTrigger>
						<DataTrigger Value="Unknown">
							<DataTrigger.Binding>
								<MultiBinding Converter="{local:BrushToDarknessConverter}">
									<Binding Path="Brush" RelativeSource="{RelativeSource Self}"/>
									<Binding Path="LightForegroundThreshold" RelativeSource="{RelativeSource Self}"/>
								</MultiBinding>
							</DataTrigger.Binding>
							<Setter TargetName="label" Property="Foreground" Value="#FF000000"/>
							<Setter TargetName="labelOutline" Property="Foreground" Value="#FFFFFFFF"/>
						</DataTrigger>
					</ControlTemplate.Triggers>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
		<Setter Property="NoBrushVisible" Value="Hidden"/>
		<Setter Property="BrushVisible" Value="Visible"/>
		<Style.Triggers>
			<Trigger Property="Brush" Value="{x:Null}">
				<Setter Property="NoBrushVisible" Value="Visible"/>
				<Setter Property="BrushVisible" Value="Hidden"/>
			</Trigger>
		</Style.Triggers>
	</Style>

	<Style TargetType="local:PropertyPresenter">
		<Setter Property="Background" Value="{DynamicResource PanelBackgroundBrush}" />
		<Setter Property="Template">
			<Setter.Value>
				<ControlTemplate TargetType="local:PropertyPresenter">
					<Border Padding="{TemplateBinding Padding}" Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}">
						<Grid>
							<Grid.ColumnDefinitions>
								<ColumnDefinition Name="delveColumn" Width="Auto" />
								<ColumnDefinition Name="labelColumn" MinWidth="100" MaxWidth="180" Width="0.4*" />
								<ColumnDefinition MinWidth="134" Width="0.6*" />
								<ColumnDefinition Name="propertyButtonColumn" Width="12" />
							</Grid.ColumnDefinitions>
							<Grid.RowDefinitions>
								<RowDefinition Height="Auto" />
								<RowDefinition Height="Auto" />
							</Grid.RowDefinitions>

							<ToggleButton Name="delveButton" Grid.Column="0" Style="{DynamicResource StandaloneToggleStyle}" Width="11" Height="11" Visibility="{Binding HasItems,ElementName=subProperties,Converter={StaticResource BoolToVisibilityConverter}}" />
							<TextBlock Name="Label" Grid.Column="1" Text="{TemplateBinding Label}" ToolTip="{Binding Property.Description,Mode=OneTime}" Height="16" TextWrapping="NoWrap" TextTrimming="CharacterEllipsis" />
							<ContentPresenter Grid.Column="2" Margin="4,2,0,2" IsEnabled="{Binding Property.CanWrite}" />
							<local:PropertyButton Grid.Column="3" ValueSource="{Binding ValueSource}" IsEnabled="{Binding Property.CanWrite,Mode=OneTime}"/>

							<ItemsControl Name="subProperties" Background="{DynamicResource PanelGroupSecondaryBackgroundBrush}" Margin="-19,0,0,0" Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="4" ItemsSource="{TemplateBinding ItemsSource}" ItemTemplate="{DynamicResource PropertyEditorTemplate}">
								<ItemsControl.Visibility>
									<MultiBinding Converter="{StaticResource BoolsToVisibilityConverter}">
										<Binding ElementName="delveButton" Path="IsChecked" />
										<Binding RelativeSource="{RelativeSource Self}" Path="HasItems" />
									</MultiBinding>
								</ItemsControl.Visibility>
							</ItemsControl>
						</Grid>
					</Border>
					<ControlTemplate.Triggers>
						<Trigger Property="Label" Value="{x:Null}">
							<Setter TargetName="labelColumn" Property="MinWidth" Value="0" />
							<Setter TargetName="labelColumn" Property="Width" Value="0" />
							<Setter TargetName="propertyButtonColumn" Property="Width" Value="0" />
						</Trigger>
						<Trigger Property="ShowPropertyButton" Value="False">
							<Setter TargetName="propertyButtonColumn" Property="Width" Value="0" />
						</Trigger>
					</ControlTemplate.Triggers>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
		<Style.Triggers>
			<Trigger Property="IsSubProperty" Value="True">
				<Setter Property="Background" Value="{DynamicResource PanelGroupSecondaryBackgroundBrush}" />
			</Trigger>
		</Style.Triggers>
	</Style>

	<ControlTemplate TargetType="Expander" x:Key="AdvancedPropertiesExpander">
		<StackPanel Background="{DynamicResource PanelGroupSecondaryBackgroundBrush}">
			<ToggleButton
				x:Name="ExpanderButton" DockPanel.Dock="Top" Template="{DynamicResource AdvancedPropertiesToggleButton}" Content="{TemplateBinding Header}" VerticalAlignment="Stretch"
				IsChecked="{Binding Path=IsExpanded, RelativeSource={RelativeSource TemplatedParent}}" OverridesDefaultStyle="True" Height="14" Padding="1.5,1,1.5,1">
			</ToggleButton>
			<ContentPresenter x:Name="ExpanderContent" Grid.Row="1" Visibility="Collapsed" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"/>
		</StackPanel>
		<ControlTemplate.Triggers>
			<Trigger Property="IsExpanded" Value="True">
				<Setter TargetName="ExpanderContent" Property="Visibility" Value="Visible"/>
			</Trigger>
		</ControlTemplate.Triggers>
	</ControlTemplate>

	<ControlTemplate x:Key="AdvancedPropertiesToggleButton" TargetType="{x:Type ToggleButton}">
		<Border x:Name="ExpanderButtonBorder" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Background="{DynamicResource PanelGroupSecondaryBackgroundBrush}" DockPanel.Dock="Top">
			<Path x:Name="Chevron" Data="M 0,3 L 5,8 L 10,3" Stroke="{DynamicResource ToggleItemForegroundBrush}" Width="10" Height="10" StrokeThickness="2"
				  HorizontalAlignment="Stretch" VerticalAlignment="Center" RenderTransformOrigin="0.5,0.5"/>
		</Border>
		<ControlTemplate.Triggers>
			<Trigger Property="IsChecked" Value="True">
				<Setter Property="Data" TargetName="Chevron" Value="M 0,8 L 5,3 L 10,8"/>
			</Trigger>
			<Trigger Property="IsMouseOver" Value="true">
				<Setter Property="Stroke" Value="{DynamicResource ToggleItemMouseOverForegroundBrush}" TargetName="Chevron"/>
			</Trigger>
			<Trigger Property="IsPressed" Value="true">
				<Setter Property="Stroke" Value="{DynamicResource ToggleItemSelectedForegroundBrush}" TargetName="Chevron"/>
			</Trigger>
		</ControlTemplate.Triggers>
	</ControlTemplate>

	<Style TargetType="{x:Type TabItem}">
		<Setter Property="Foreground" Value="{DynamicResource PanelForegroundBrush}"/>
		<Setter Property="BorderThickness" Value="1"/>
		<Setter Property="TextElement.Foreground" Value="{DynamicResource ToggleItemForegroundBrush}"/>
		<Setter Property="Template">
			<Setter.Value>
				<ControlTemplate TargetType="{x:Type TabItem}">
					<Border x:Name="grid" BorderThickness="1" Padding="4" BorderBrush="{DynamicResource ToggleItemBorderBrush}"
							Background="{DynamicResource ToggleItemBackgroundBrush}" TextElement.Foreground="{DynamicResource ToggleItemForegroundBrush}">
						<ContentPresenter x:Name="tabContent" ContentSource="Header"/>
					</Border>
					<ControlTemplate.Triggers>
						<Trigger Property="IsSelected" Value="True">
							<Setter TargetName="grid" Property="BorderBrush" Value="{DynamicResource ToggleItemSelectedBorderBrush}"/>
							<Setter TargetName="grid" Property="Background" Value="{DynamicResource ToggleItemSelectedBackgroundBrush}"/>
							<Setter TargetName="grid" Property="TextElement.Foreground" Value="{DynamicResource ToggleItemSelectedForegroundBrush}"/>
						</Trigger>
						<Trigger Property="IsMouseOver" Value="True">
							<Setter TargetName="grid" Property="BorderBrush" Value="{DynamicResource ToggleItemMouseOverBorderBrush}"/>
							<Setter TargetName="grid" Property="Background" Value="{DynamicResource ToggleItemMouseOverBackgroundBrush}"/>
							<Setter TargetName="grid" Property="TextElement.Foreground" Value="{DynamicResource ToggleItemMouseOverForegroundBrush}"/>
						</Trigger>
						<Trigger Property="Button.IsPressed" Value="True">
							<Setter TargetName="grid" Property="BorderBrush" Value="{DynamicResource ToggleItemPressedBorderBrush}"/>
							<Setter TargetName="grid" Property="Background" Value="{DynamicResource ToggleItemPressedBackgroundBrush}"/>
						</Trigger>
					</ControlTemplate.Triggers>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>
	
	<Style TargetType="{x:Type TabControl}">
		<Setter Property="Foreground" Value="{DynamicResource PanelForegroundBrush}"/>
		<Setter Property="BorderThickness" Value="0"/>
		<Setter Property="Template">
			<Setter.Value>
				<ControlTemplate TargetType="TabControl">
					<Grid UseLayoutRounding="True">
						<Grid.RowDefinitions>
							<RowDefinition />
							<RowDefinition Height="*" />
						</Grid.RowDefinitions>
						<TabPanel IsItemsHost="True" Grid.Row="0" Panel.ZIndex="1" />
						<Border Grid.Row="1" Panel.ZIndex="0" BorderThickness="0,1,1,1" Padding="4"
							Background="{DynamicResource ToggleItemOuterBorderBrush}" BorderBrush="{DynamicResource ToggleItemOuterBorderBrush}">
							<ContentPresenter ContentSource="SelectedContent" />
						</Border>
					</Grid>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>

	<Style TargetType="Label">
		<Setter Property="Foreground" Value="{DynamicResource PanelForegroundBrush}"/>
	</Style>

	<Style TargetType="ListBox">
		<Setter Property="Background" Value="{DynamicResource ListBackgroundBrush}" />
		<Setter Property="BorderBrush" Value="{DynamicResource ListBackgroundBrush}" />
	</Style>
	
	<Style TargetType="ListBoxItem">
		<Setter Property="SnapsToDevicePixels" Value="True"/>
		<Setter Property="Padding" Value="4,1"/>
		<Setter Property="HorizontalContentAlignment" Value="{Binding HorizontalContentAlignment, RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}"/>
		<Setter Property="VerticalContentAlignment" Value="{Binding VerticalContentAlignment, RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}"/>
		<Setter Property="Foreground" Value="{DynamicResource ListItemForegroundBrush}" />
		<Setter Property="Background" Value="Transparent"/>
		<Setter Property="BorderBrush" Value="Transparent"/>
		<Setter Property="BorderThickness" Value="1"/>
		<Setter Property="FocusVisualStyle" Value="{StaticResource GenericVisualFocusStyle}"/>
		<Setter Property="Template">
			<Setter.Value>
				<ControlTemplate TargetType="{x:Type ListBoxItem}">
					<Border x:Name="Bd" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Background="{TemplateBinding Background}" Padding="{TemplateBinding Padding}" SnapsToDevicePixels="true">
						<ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
					</Border>
					<ControlTemplate.Triggers>
						<MultiTrigger>
							<MultiTrigger.Conditions>
								<Condition Property="IsMouseOver" Value="True"/>
							</MultiTrigger.Conditions>
							<Setter Property="Background" TargetName="Bd" Value="{DynamicResource ListItemMouseOverBackgroundBrush}"/>
							<Setter Property="BorderBrush" TargetName="Bd" Value="{DynamicResource ListItemMouseOverBorderBrush}"/>
							<Setter Property="TextElement.Foreground" TargetName="Bd" Value="{DynamicResource ListItemMouseOverForegroundBrush}" />
						</MultiTrigger>
						<MultiTrigger>
							<MultiTrigger.Conditions>
								<Condition Property="IsSelected" Value="True"/>
							</MultiTrigger.Conditions>
							<Setter Property="Background" TargetName="Bd" Value="{DynamicResource ListItemSelectedBackgroundBrush}"/>
							<Setter Property="BorderBrush" TargetName="Bd" Value="{DynamicResource ListItemSelectedBorderBrush}"/>
							<Setter Property="TextElement.Foreground" TargetName="Bd" Value="{DynamicResource ListItemSelectedForegroundBrush}" />
						</MultiTrigger>
						<Trigger Property="IsEnabled" Value="False">
							<Setter Property="TextElement.Foreground" TargetName="Bd" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"/>
						</Trigger>
					</ControlTemplate.Triggers>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>

	<Style TargetType="MenuItem">
		<Setter Property="HorizontalContentAlignment" Value="{Binding Path=HorizontalContentAlignment, RelativeSource={RelativeSource FindAncestor, AncestorLevel=1, AncestorType={x:Type ItemsControl}}}"/>
		<Setter Property="VerticalContentAlignment" Value="{Binding Path=VerticalContentAlignment, RelativeSource={RelativeSource FindAncestor, AncestorLevel=1, AncestorType={x:Type ItemsControl}}}"/>
		<Setter Property="Foreground" Value="{DynamicResource ListItemForegroundBrush}" />
		<Setter Property="Background" Value="Transparent" />
		<Setter Property="BorderBrush" Value="Transparent" />
		<Setter Property="BorderThickness" Value="1" />
		<Setter Property="Padding" Value="0,0,0,0" />
		<Setter Property="Template">
			<Setter.Value>
				<ControlTemplate TargetType="MenuItem">
					<Border x:Name="templateRoot" Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" SnapsToDevicePixels="True">
						<Grid Margin="{TemplateBinding Padding}">
							<Grid.ColumnDefinitions>
								<ColumnDefinition MinWidth="17" SharedSizeGroup="MenuItemIconColumnGroup" Width="Auto"/>
								<ColumnDefinition Width="*"/>
								<ColumnDefinition SharedSizeGroup="MenuItemIGTColumnGroup" Width="Auto"/>
								<ColumnDefinition Width="14"/>
							</Grid.ColumnDefinitions>
							<ContentPresenter x:Name="Icon" Grid.Column="0" ContentSource="Icon" Content="{TemplateBinding Icon}" Margin="4,0,6,0" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" VerticalAlignment="Center" />
							<Path x:Name="GlyphPanel" Data="M0,2L0,4.8 2.5,7.4 7.1,2.8 7.1,0 2.5,4.6z" Grid.Column="0" Margin="4,0,6,0" Visibility="Hidden" Fill="{TemplateBinding Foreground}" FlowDirection="LeftToRight" VerticalAlignment="Center" />
							<ContentPresenter x:Name="menuHeaderContainer" Grid.Column="1" ContentSource="Header" Content="{TemplateBinding Header}" ContentTemplateSelector="{TemplateBinding HeaderTemplateSelector}" ContentTemplate="{TemplateBinding HeaderTemplate}" Margin="0,2,0,2" ContentStringFormat="{TemplateBinding HeaderStringFormat}" HorizontalAlignment="Left" RecognizesAccessKey="True" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" VerticalAlignment="Center"/>
							<TextBlock x:Name="menuGestureText" Grid.Column="2" Margin="5,2,0,2" DockPanel.Dock="Right" Text="{TemplateBinding InputGestureText}" VerticalAlignment="Center"/>
						</Grid>
					</Border>
					<ControlTemplate.Triggers>
						<Trigger Property="Icon" Value="{x:Null}">
							<Setter Property="Visibility" TargetName="Icon" Value="Collapsed"/>
						</Trigger>
						<Trigger Property="IsChecked" Value="True">
							<Setter Property="Visibility" TargetName="GlyphPanel" Value="Visible"/>
							<Setter Property="Visibility" TargetName="Icon" Value="Collapsed"/>
						</Trigger>
					</ControlTemplate.Triggers>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
		<Style.Triggers>
			<Trigger Property="IsHighlighted" Value="True">
				<Setter Property="Foreground" Value="{DynamicResource ListItemHighlightForegroundBrush}" />
				<Setter Property="BorderBrush" Value="{DynamicResource ListItemHighlightBorderBrush}" />
				<Setter Property="Background" Value="{DynamicResource ListItemHighlightBackgroundBrush}" />
			</Trigger>
			<Trigger Property="IsEnabled" Value="False">
				<Setter Property="Foreground" Value="{DynamicResource ListItemDisabledForegroundBrush}" />
			</Trigger>
		</Style.Triggers>
	</Style>

	<Style x:Key="HeaderedMenuItem" BasedOn="{StaticResource {x:Type MenuItem}}" TargetType="MenuItem">
		<Setter Property="Padding" Value="21,0,0,0" />
	</Style>

	<Style TargetType="{x:Type ContextMenu}">
		<Setter Property="Foreground" Value="{DynamicResource ListItemForegroundBrush}" />
		<Setter Property="OverridesDefaultStyle" Value="True" />
		<Setter Property="FontFamily" Value="{DynamicResource {x:Static SystemFonts.MessageFontFamilyKey}}" />
		<Setter Property="FontSize" Value="{DynamicResource {x:Static SystemFonts.MessageFontSizeKey}}" />
		<Setter Property="FontWeight" Value="{DynamicResource {x:Static SystemFonts.MessageFontWeightKey}}" />
		<Setter Property="SnapsToDevicePixels" Value="True" />
		<Setter Property="Background" Value="{DynamicResource MenuPopupBackgroundBrush}" />
		<Setter Property="Grid.IsSharedSizeScope" Value="true" />
		<Setter Property="VerticalContentAlignment" Value="Center" />
		<Setter Property="Padding" Value="2" />
		<Setter Property="BorderThickness" Value="1" />
		<Setter Property="BorderBrush" Value="{DynamicResource MenuPopupBorderBrush}" />
		<Setter Property="HasDropShadow" Value="{DynamicResource {x:Static SystemParameters.DropShadowKey}}" />
		<Setter Property="Template">
			<Setter.Value>
				<ControlTemplate TargetType="{x:Type ContextMenu}">
					<theme:SystemDropShadowChrome x:Name="shadow" Color="Transparent">
						<Border x:Name="Border" Background="{TemplateBinding Background}" BorderThickness="{TemplateBinding BorderThickness}" BorderBrush="{TemplateBinding BorderBrush}">
							<ScrollViewer CanContentScroll="True" Style="{DynamicResource {ComponentResourceKey TypeInTargetAssembly={x:Type FrameworkElement}, ResourceId=MenuScrollViewer}}">
								<ItemsPresenter Margin="{TemplateBinding Padding}" KeyboardNavigation.DirectionalNavigation="Cycle" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
							</ScrollViewer>
						</Border>
					</theme:SystemDropShadowChrome>
					
					<ControlTemplate.Triggers>
						<MultiDataTrigger>
							<MultiDataTrigger.Conditions>
								<Condition Binding="{Binding HasDropShadow,RelativeSource={RelativeSource Self}}" Value="True" />
								<Condition Binding="{Binding AreGradientsAllowed,Source={x:Static local:HostEnvironment.Current}}" Value="True" />
							</MultiDataTrigger.Conditions>
							
							<Setter TargetName="shadow" Property="Margin" Value="0,0,5,5" />
							<Setter TargetName="shadow" Property="Color" Value="{DynamicResource DropShadowBackgroundColor}" />
						</MultiDataTrigger>
					</ControlTemplate.Triggers>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>

	<Style TargetType="{x:Type local:HeaderedContextMenu}" BasedOn="{StaticResource {x:Type ContextMenu}}">
		<Setter Property="Padding" Value="2,0,2,14" />
		<Setter Property="Template">
			<Setter.Value>
				<ControlTemplate TargetType="{x:Type local:HeaderedContextMenu}">
					<theme:SystemDropShadowChrome x:Name="shadow" Color="Transparent">
						<Border x:Name="Border" Padding="0,2,0,4" Background="{TemplateBinding Background}" BorderThickness="{TemplateBinding BorderThickness}" BorderBrush="{TemplateBinding BorderBrush}">
							<StackPanel>
								<Label Content="{TemplateBinding Header}" ContentTemplate="{TemplateBinding HeaderTemplate}" Margin="13,3,12,2" Padding="0" Foreground="{TemplateBinding Foreground}" />
								<ItemsPresenter Margin="{TemplateBinding Padding}" HorizontalAlignment="Stretch" KeyboardNavigation.DirectionalNavigation="Cycle" />
							</StackPanel>
						</Border>
					</theme:SystemDropShadowChrome>

					<ControlTemplate.Triggers>
						<MultiDataTrigger>
							<MultiDataTrigger.Conditions>
								<Condition Binding="{Binding HasDropShadow,RelativeSource={RelativeSource Self}}" Value="True" />
								<Condition Binding="{Binding AreGradientsAllowed,Source={x:Static local:HostEnvironment.Current}}" Value="True" />
							</MultiDataTrigger.Conditions>

							<Setter TargetName="shadow" Property="Margin" Value="0,0,5,5" />
							<Setter TargetName="shadow" Property="Color" Value="{DynamicResource DropShadowBackgroundColor}" />
						</MultiDataTrigger>
					</ControlTemplate.Triggers>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
		<Setter Property="ItemContainerStyleSelector">
			<Setter.Value>
				<local:PropertyMenuItemContainerStyleSelector MenuItemStyle="{StaticResource HeaderedMenuItem}">
					<local:PropertyMenuItemContainerStyleSelector.SeparatorStyle>
						<Style TargetType="Separator" BasedOn="{StaticResource {x:Type Separator}}">
							<Setter Property="Margin" Value="4,2,0,2" />
							<Setter Property="Background" Value="{DynamicResource MenuSeparatorBrush}" />
							<Setter Property="Template">
								<Setter.Value>
									<ControlTemplate TargetType="Separator">
										<Border Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" />
									</ControlTemplate>
								</Setter.Value>
							</Setter>
						</Style>
					</local:PropertyMenuItemContainerStyleSelector.SeparatorStyle>
				</local:PropertyMenuItemContainerStyleSelector>
			</Setter.Value>
		</Setter>
	</Style>

	<Style x:Key="ArrangeMenuItem" TargetType="MenuItem" BasedOn="{StaticResource {x:Type MenuItem}}">
		<Setter Property="Header" Value="{Binding ArrangeMode,Mode=OneTime}" />
		<Setter Property="IsCheckable" Value="True" />
		<Setter Property="IsChecked" Value="{Binding IsChecked,Mode=TwoWay}" />
	</Style>

	<Style x:Key="IconButton" TargetType="Button">
		<Setter Property="Background" Value="{DynamicResource IconButtonSimpleBackgroundBrush}" />
		<Setter Property="Foreground" Value="{DynamicResource IconButtonForegroundBrush}" />
		<Setter Property="BorderBrush" Value="Transparent" />
		<Setter Property="ContentTemplate">
			<Setter.Value>
				<DataTemplate>
					<Rectangle Height="16" Width="16" VerticalAlignment="Center">
						<Rectangle.Fill>
							<DrawingBrush Stretch="None">
								<DrawingBrush.Drawing>
									<GeometryDrawing Brush="{Binding Foreground,RelativeSource={RelativeSource AncestorType=Button}}" Geometry="{Binding Content,RelativeSource={RelativeSource AncestorType=Button}}" />
								</DrawingBrush.Drawing>
							</DrawingBrush>
						</Rectangle.Fill>
					</Rectangle>
				</DataTemplate>
			</Setter.Value>
		</Setter>
	</Style>

	<Style x:Key="SearchButtonBase" TargetType="Button" BasedOn="{StaticResource IconButton}">
		<Setter Property="Margin" Value="-1" />
		<Setter Property="Template">
			<Setter.Value>
				<ControlTemplate TargetType="{x:Type Button}">
					<Border x:Name="border" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Background="{TemplateBinding Background}" SnapsToDevicePixels="true">
						<ContentPresenter x:Name="contentPresenter" Focusable="False" HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" Margin="{TemplateBinding Padding}" RecognizesAccessKey="True" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
					</Border>
					<ControlTemplate.Triggers>
						<Trigger Property="IsDefaulted" Value="true">
							<Setter Property="BorderBrush" TargetName="border" Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}"/>
						</Trigger>
						<Trigger Property="IsMouseOver" Value="true">
							<Setter Property="Foreground" Value="{DynamicResource IconButtonMouseOverForegroundBrush}" />
							<Setter Property="Background" TargetName="border" Value="{DynamicResource SearchControlButtonMouseOverBackgroundBrush}" />
							<Setter Property="BorderBrush" TargetName="border" Value="{DynamicResource SearchControlButtonMouseOverBorderBrush}" />
						</Trigger>
						<Trigger Property="IsPressed" Value="true">
							<Setter Property="Foreground" Value="{DynamicResource IconButtonPressedForegroundBrush}" />
							<Setter Property="Background" TargetName="border" Value="{DynamicResource SearchControlButtonPressedBackgroundBrush}" />
							<Setter Property="BorderBrush" TargetName="border" Value="{DynamicResource SearchControlButtonPressedBorderBrush}" />
						</Trigger>
						<!--<Trigger Property="IsEnabled" Value="false">
							<Setter Property="Background" TargetName="border" Value="{StaticResource Button.Disabled.Background}"/>
							<Setter Property="BorderBrush" TargetName="border" Value="{StaticResource Button.Disabled.Border}"/>
							<Setter Property="TextElement.Foreground" TargetName="contentPresenter" Value="{StaticResource Button.Disabled.Foreground}"/>
						</Trigger>!-->
					</ControlTemplate.Triggers>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>

	<Style x:Key="SearchButton" TargetType="Button" BasedOn="{StaticResource SearchButtonBase}">
		<Setter Property="Content" Value="{DynamicResource SearchLoopIcon}" />
	</Style>

	<Style x:Key="ClearButton" TargetType="Button" BasedOn="{StaticResource SearchButtonBase}">
		<Setter Property="Content" Value="{DynamicResource ClearSearchIcon}" />
	</Style>

	<Style TargetType="local:TextBoxEx">
		<Setter Property="Background" Value="{DynamicResource InputBackgroundBrush}" />
		<Setter Property="BorderBrush" Value="{DynamicResource InputBorderBrush}" />
		<Setter Property="Foreground" Value="{DynamicResource InputForegroundBrush}" />
		<Setter Property="BorderThickness" Value="1"/>
		<Setter Property="KeyboardNavigation.TabNavigation" Value="None"/>
		<Setter Property="HorizontalContentAlignment" Value="Left"/>
		<Setter Property="VerticalContentAlignment" Value="Center" />
		<Setter Property="FocusVisualStyle" Value="{x:Null}"/>
		<Setter Property="AllowDrop" Value="true"/>
		<Setter Property="ScrollViewer.PanningMode" Value="VerticalFirst"/>
		<Setter Property="Stylus.IsFlicksEnabled" Value="False"/>
		<Setter Property="ClearButtonStyle" Value="{StaticResource ClearButton}" />
		<Setter Property="Template">
			<Setter.Value>
				<ControlTemplate TargetType="{x:Type local:TextBoxEx}">
					<Border x:Name="border" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Background="{TemplateBinding Background}" SnapsToDevicePixels="True">
						<Grid>
							<Grid.ColumnDefinitions>
								<ColumnDefinition Width="*" />
								<ColumnDefinition Width="Auto" />
							</Grid.ColumnDefinitions>

							<ContentPresenter Grid.Column="0" Name="hintContent" Margin="2,0,2,0" Visibility="Collapsed" ContentSource="Hint" />
							<ScrollViewer x:Name="PART_ContentHost" Grid.Column="0" Focusable="false" HorizontalScrollBarVisibility="Hidden" VerticalScrollBarVisibility="Hidden"/>

							<Button Name="PART_Clear" Grid.Column="1" Style="{TemplateBinding ClearButtonStyle}" Visibility="{TemplateBinding ShowClearButton,Converter={StaticResource BoolToVisibilityConverter}}" />
							<Button Name="PART_Submit" Grid.Column="1" Style="{TemplateBinding SubmitButtonStyle}" Visibility="Collapsed" />
						</Grid>
					</Border>
					<ControlTemplate.Triggers>
						<Trigger Property="IsEnabled" Value="false">
							<Setter Property="Opacity" TargetName="border" Value="0.56"/>
						</Trigger>
						<MultiTrigger>
							<MultiTrigger.Conditions>
								<Condition Property="Text" Value="{x:Static system:String.Empty}" />
								<Condition Property="ShowClearButton" Value="True" />
							</MultiTrigger.Conditions>
							<Setter TargetName="PART_Clear" Property="Visibility" Value="Collapsed" />
							<Setter TargetName="PART_Submit" Property="Visibility" Value="Visible" />
						</MultiTrigger>
						<MultiTrigger>
							<MultiTrigger.Conditions>
								<Condition Property="Text" Value="{x:Null}" />
								<Condition Property="ShowClearButton" Value="True" />
							</MultiTrigger.Conditions>
							<Setter TargetName="PART_Clear" Property="Visibility" Value="Collapsed" />
							<Setter TargetName="PART_Submit" Property="Visibility" Value="Visible" />
						</MultiTrigger>
						<Trigger Property="Text" Value="{x:Static system:String.Empty}">
							<Setter TargetName="hintContent" Property="Visibility" Value="Visible" />
						</Trigger>
						<Trigger Property="Text" Value="{x:Null}">
							<Setter TargetName="hintContent" Property="Visibility" Value="Visible" />
						</Trigger>
						<Trigger Property="IsFocused" Value="True">
							<Setter TargetName="hintContent" Property="Visibility" Value="Collapsed" />
						</Trigger>
					</ControlTemplate.Triggers>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
		<Style.Triggers>
			<MultiTrigger>
				<MultiTrigger.Conditions>
					<Condition Property="IsInactiveSelectionHighlightEnabled" Value="true"/>
					<Condition Property="IsSelectionActive" Value="false"/>
				</MultiTrigger.Conditions>
				<Setter Property="SelectionBrush" Value="{DynamicResource {x:Static SystemColors.InactiveSelectionHighlightBrushKey}}"/>
			</MultiTrigger>
		</Style.Triggers>
	</Style>

	<local:NumericTemplateSelector x:Key="NumericTemplateSelector">
		<local:NumericTemplateSelector.FloatingTemplate>
			<DataTemplate DataType="vm:FloatingPropertyViewModel">
				<local:DoubleUpDownControl Value="{Binding Value}" IsEnabled="{Binding Property.CanWrite,Mode=OneTime}" AutomationProperties.Name="{Binding Property.Name,Mode=OneTime}" />
			</DataTemplate>
		</local:NumericTemplateSelector.FloatingTemplate>
		<local:NumericTemplateSelector.IntegerTemplate>
			<DataTemplate DataType="vm:IntegerPropertyViewModel">
				<local:IntegerUpDownControl Value="{Binding Value}" IsEnabled="{Binding Property.CanWrite,Mode=OneTime}" AutomationProperties.Name="{Binding Property.Name,Mode=OneTime}" />
			</DataTemplate>
		</local:NumericTemplateSelector.IntegerTemplate>
		<local:NumericTemplateSelector.ByteTemplate>
			<DataTemplate DataType="vm:BytePropertyViewModel">
				<local:ByteUpDownControl Value="{Binding Value}" IsEnabled="{Binding Property.CanWrite,Mode=OneTime}" AutomationProperties.LabeledBy="{TemplateBinding AutomationProperties.LabeledBy}" />
			</DataTemplate>
		</local:NumericTemplateSelector.ByteTemplate>
	</local:NumericTemplateSelector>

	<Style TargetType="local:NumericEditorControl">
		<Setter Property="Height" Value="24" />
		<Setter Property="Template">
			<Setter.Value>
				<ControlTemplate TargetType="local:NumericEditorControl">
					<ContentPresenter Content="{Binding}" ContentTemplateSelector="{StaticResource NumericTemplateSelector}" AutomationProperties.Name="{Binding Property.Name,Mode=OneTime}" />
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>

	<Style TargetType="local:IntegerUpDownControl" BasedOn="{StaticResource {x:Type local:TextBoxEx}}">
		<Setter Property="Height" Value="24" />
		<Setter Property="MinHeight" Value="20" />
		<Setter Property="FocusSelectsAll" Value="True" />
	</Style>

	<Style TargetType="local:DoubleUpDownControl" BasedOn="{StaticResource {x:Type local:TextBoxEx}}">
		<Setter Property="Height" Value="24" />
		<Setter Property="MinHeight" Value="20" />
		<Setter Property="FocusSelectsAll" Value="True" />
	</Style>

	<Style TargetType="local:ByteUpDownControl" BasedOn="{StaticResource {x:Type local:TextBoxEx}}">
		<Setter Property="Height" Value="24" />
		<Setter Property="MinHeight" Value="20" />
		<Setter Property="FocusSelectsAll" Value="True" />
	</Style>

	<Style x:Key="SearchTextBox" TargetType="local:TextBoxEx" BasedOn="{StaticResource {x:Type local:TextBoxEx}}">
		<Setter Property="ShowClearButton" Value="True" />
		<Setter Property="SubmitButtonStyle" Value="{StaticResource SearchButton}" />
		<Setter Property="Background" Value="{DynamicResource SearchControlBackgroundBrush}" />
		<Setter Property="BorderBrush" Value="{DynamicResource SearchControlBorderBrush}" />
		<Setter Property="HintTemplate">
			<Setter.Value>
				<DataTemplate>
					<TextBlock Text="{Binding}" Foreground="{DynamicResource SearchControlWatermarkBrush}" />
				</DataTemplate>
			</Setter.Value>
		</Setter>
		<Style.Triggers>
			<Trigger Property="IsMouseOver" Value="True">
				<Setter Property="Background" Value="{DynamicResource SearchControlActiveBackgroundBrush}" />
				<Setter Property="BorderBrush" Value="{DynamicResource SearchControlActiveBorderBrush}" />
				<Setter Property="Foreground" Value="{DynamicResource SearchControlActiveForegroundBrush}" />
			</Trigger>
			<Trigger Property="IsFocused" Value="True">
				<Setter Property="Background" Value="{DynamicResource SearchControlActiveBackgroundBrush}" />
				<Setter Property="BorderBrush" Value="{DynamicResource SearchControlActiveBorderBrush}" />
				<Setter Property="Foreground" Value="{DynamicResource SearchControlActiveForegroundBrush}" />
			</Trigger>
		</Style.Triggers>
	</Style>

	<Style x:Key="PropertySearchTextBox" TargetType="local:TextBoxEx" BasedOn="{StaticResource SearchTextBox}">
		<Setter Property="Margin" Value="4,1,4,2" />
		<Setter Property="Height" Value="18" />
	</Style>

	<PathGeometry x:Key="TreeArrow" Figures="M0,0 L0,6 L6,0 z"/>
	<Style x:Key="ExpandCollapseToggleStyle" TargetType="{x:Type ToggleButton}">
		<Setter Property="Focusable" Value="False"/>
		<Setter Property="Template">
			<Setter.Value>
				<ControlTemplate TargetType="{x:Type ToggleButton}">
					<Grid>
						<Grid.ColumnDefinitions>
							<ColumnDefinition Width="19" />
							<ColumnDefinition Width="*" />
						</Grid.ColumnDefinitions>

						<Border Grid.Column="0" Background="Transparent" Height="16" Padding="5,5,5,5" Width="16">
							<Path x:Name="ExpandPath" Data="{StaticResource TreeArrow}" Fill="{DynamicResource TreeViewItem.TreeArrow.Static.Fill}" Stroke="{DynamicResource TreeViewItem.TreeArrow.Static.Stroke}">
								<Path.RenderTransform>
									<RotateTransform Angle="135" CenterY="3" CenterX="3"/>
								</Path.RenderTransform>
							</Path>
						</Border>

						<ContentPresenter Grid.Column="1" />
					</Grid>
					<ControlTemplate.Triggers>
						<Trigger Property="IsChecked" Value="True">
							<Setter Property="RenderTransform" TargetName="ExpandPath">
								<Setter.Value>
									<RotateTransform Angle="180" CenterY="3" CenterX="3"/>
								</Setter.Value>
							</Setter>
							<Setter Property="Fill" TargetName="ExpandPath" Value="{DynamicResource TreeViewItem.TreeArrow.Static.Checked.Fill}"/>
							<Setter Property="Stroke" TargetName="ExpandPath" Value="{DynamicResource TreeViewItem.TreeArrow.Static.Checked.Stroke}"/>
						</Trigger>
						<Trigger Property="IsMouseOver" Value="True">
							<Setter Property="Stroke" TargetName="ExpandPath" Value="{DynamicResource TreeViewItem.TreeArrow.MouseOver.Stroke}"/>
							<Setter Property="Fill" TargetName="ExpandPath" Value="{DynamicResource TreeViewItem.TreeArrow.MouseOver.Fill}"/>
						</Trigger>
						<MultiTrigger>
							<MultiTrigger.Conditions>
								<Condition Property="IsMouseOver" Value="True"/>
								<Condition Property="IsChecked" Value="True"/>
							</MultiTrigger.Conditions>
							<Setter Property="Stroke" TargetName="ExpandPath" Value="{DynamicResource TreeViewItem.TreeArrow.MouseOver.Checked.Stroke}"/>
							<Setter Property="Fill" TargetName="ExpandPath" Value="{DynamicResource TreeViewItem.TreeArrow.MouseOver.Checked.Fill}"/>
						</MultiTrigger>
					</ControlTemplate.Triggers>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>

	<Style x:Key="StandaloneToggleStyle" TargetType="ToggleButton">
		<Setter Property="Template">
			<Setter.Value>
				<ControlTemplate TargetType="ToggleButton">
					<Border Grid.Column="0" Background="Transparent">
						<Path x:Name="ExpandPath" Data="{StaticResource TreeArrow}" Fill="{DynamicResource TreeViewItem.TreeArrow.Static.Fill}" Stroke="{DynamicResource TreeViewItem.TreeArrow.Static.Stroke}">
							<Path.RenderTransform>
								<RotateTransform Angle="135" CenterY="3" CenterX="3"/>
							</Path.RenderTransform>
						</Path>
					</Border>
					<ControlTemplate.Triggers>
						<Trigger Property="IsChecked" Value="True">
							<Setter Property="RenderTransform" TargetName="ExpandPath">
								<Setter.Value>
									<RotateTransform Angle="180" CenterY="3" CenterX="3"/>
								</Setter.Value>
							</Setter>
							<Setter Property="Fill" TargetName="ExpandPath" Value="{DynamicResource TreeViewItem.TreeArrow.Static.Checked.Fill}"/>
							<Setter Property="Stroke" TargetName="ExpandPath" Value="{DynamicResource TreeViewItem.TreeArrow.Static.Checked.Stroke}"/>
						</Trigger>
						<Trigger Property="IsMouseOver" Value="True">
							<Setter Property="Stroke" TargetName="ExpandPath" Value="{DynamicResource TreeViewItem.TreeArrow.MouseOver.Stroke}"/>
							<Setter Property="Fill" TargetName="ExpandPath" Value="{DynamicResource TreeViewItem.TreeArrow.MouseOver.Fill}"/>
						</Trigger>
						<MultiTrigger>
							<MultiTrigger.Conditions>
								<Condition Property="IsMouseOver" Value="True"/>
								<Condition Property="IsChecked" Value="True"/>
							</MultiTrigger.Conditions>
							<Setter Property="Stroke" TargetName="ExpandPath" Value="{DynamicResource TreeViewItem.TreeArrow.MouseOver.Checked.Stroke}"/>
							<Setter Property="Fill" TargetName="ExpandPath" Value="{DynamicResource TreeViewItem.TreeArrow.MouseOver.Checked.Fill}"/>
						</MultiTrigger>
					</ControlTemplate.Triggers>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>

	<local:MultiplyMarginConverter x:Key="MultiplyMarginConverter" />

	<Style x:Key="SelectionTreeViewItem" TargetType="{x:Type local:TreeViewItemEx}">
		<Setter Property="OverridesDefaultStyle" Value="True" />
		<Setter Property="Background" Value="Transparent"/>
		<Setter Property="Foreground" Value="{DynamicResource ListItemForegroundBrush}" />
		<Setter Property="HorizontalContentAlignment" Value="{Binding HorizontalContentAlignment, RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}"/>
		<Setter Property="VerticalContentAlignment" Value="{Binding VerticalContentAlignment, RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}"/>
		<Setter Property="Padding" Value="1,0,0,0"/>
		<Setter Property="FocusVisualStyle">
			<Setter.Value>
				<Style BasedOn="{StaticResource GenericVisualFocusStyle}" TargetType="Control">
					<Setter Property="Margin" Value="0" />
				</Style>
			</Setter.Value>
		</Setter>
		<Setter Property="MinHeight" Value="20" />
		<Setter Property="Padding" Value="4,2,4,2" />
		<Setter Property="BorderThickness" Value="1" />
		<Setter Property="ChildMargin" Value="19,0,0,0" />
		<Setter Property="Template">
			<Setter.Value>
				<ControlTemplate TargetType="{x:Type local:TreeViewItemEx}">
					<StackPanel Orientation="Vertical">
						<Border x:Name="Bd" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Background="{TemplateBinding Background}" Padding="{TemplateBinding Padding}" SnapsToDevicePixels="true">
							<Grid MinHeight="18">
								<Grid.Margin>
									<MultiBinding Converter="{StaticResource MultiplyMarginConverter}">
										<Binding RelativeSource="{RelativeSource TemplatedParent}" Path="ChildMargin" />
										<Binding RelativeSource="{RelativeSource TemplatedParent}" Path="IndentLevel" />
									</MultiBinding>
								</Grid.Margin>
								<Grid.ColumnDefinitions>
									<ColumnDefinition MinWidth="19" Width="Auto"/>
									<ColumnDefinition Width="Auto"/>
									<ColumnDefinition Width="*"/>
								</Grid.ColumnDefinitions>

								<ToggleButton x:Name="Expander" ClickMode="Press" IsChecked="{Binding IsExpanded, RelativeSource={RelativeSource TemplatedParent}}" Style="{StaticResource ExpandCollapseToggleStyle}"/>
								<ContentPresenter x:Name="PART_Header" Grid.Column="1" ContentSource="Header" HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
							</Grid>
						</Border>
						
						<ItemsPresenter x:Name="ItemsHost" />
					</StackPanel>
					<ControlTemplate.Triggers>
						<Trigger Property="IsExpanded" Value="false">
							<Setter Property="Visibility" TargetName="ItemsHost" Value="Collapsed"/>
						</Trigger>
						<Trigger Property="HasItems" Value="false">
							<Setter Property="Visibility" TargetName="Expander" Value="Hidden"/>
						</Trigger>
					</ControlTemplate.Triggers>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
		<Style.Triggers>
			<Trigger Property="IsMouseOverItem" Value="True">
				<Setter Property="Background" Value="{DynamicResource ListItemHighlightBackgroundBrush}" />
				<Setter Property="Foreground" Value="{DynamicResource ListItemHighlightForegroundBrush}" />
				<Setter Property="BorderBrush" Value="{DynamicResource ListItemHighlightBorderBrush}" />
			</Trigger>
			<MultiTrigger>
				<MultiTrigger.Conditions>
					<Condition Property="IsSelected" Value="True" />
					<Condition Property="HasItems" Value="False" />
				</MultiTrigger.Conditions>

				<Setter Property="Background" Value="{DynamicResource ListItemSelectedBackgroundBrush}"/>
				<Setter Property="Foreground" Value="{DynamicResource ListItemSelectedForegroundBrush}"/>
				<Setter Property="BorderBrush" Value="{DynamicResource ListItemSelectedBorderBrush}" />
			</MultiTrigger>
			<Trigger Property="IsEnabled" Value="false">
				<Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"/>
			</Trigger>
			<Trigger Property="HasItems" Value="True">
				<Setter Property="IsSelectable" Value="False" />
			</Trigger>
			<Trigger Property="VirtualizingPanel.IsVirtualizing" Value="true">
				<Setter Property="ItemsPanel">
					<Setter.Value>
						<ItemsPanelTemplate>
							<VirtualizingStackPanel/>
						</ItemsPanelTemplate>
					</Setter.Value>
				</Setter>
			</Trigger>
		</Style.Triggers>
	</Style>

	<Style x:Key="SelectionTreeView" TargetType="local:TreeViewEx">
		<Setter Property="ItemContainerStyle" Value="{StaticResource SelectionTreeViewItem}" />
	</Style>

	<Style x:Key="RepeatButtonTransparent" TargetType="{x:Type RepeatButton}">
		<Setter Property="OverridesDefaultStyle" Value="True" />
		<Setter Property="IsTabStop" Value="False" />
		<Setter Property="Focusable" Value="False" />
		<Setter Property="Background" Value="Transparent" />
		<Setter Property="Template">
			<Setter.Value>
				<ControlTemplate TargetType="RepeatButton">
					<Rectangle Height="{TemplateBinding Height}" Width="{TemplateBinding Width}" Fill="{TemplateBinding Background}" />
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>

	<Style x:Key="ScrollBarThumbVertical" TargetType="{x:Type Thumb}">
		<Setter Property="OverridesDefaultStyle" Value="true"/>
		<Setter Property="IsTabStop" Value="false"/>
		<Setter Property="BorderBrush" Value="{DynamicResource VS.Environment.ScrollBarBackgroundBrush}" />
		<Setter Property="BorderThickness" Value="4,0,4,0" />
		<Setter Property="Background" Value="{DynamicResource VS.Environment.ScrollBarThumbBackgroundBrush}" />
		<Setter Property="Template">
			<Setter.Value>
				<ControlTemplate TargetType="{x:Type Thumb}">
					<Border x:Name="rectangle" Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" />
				</ControlTemplate>
			</Setter.Value>
		</Setter>
		<Style.Triggers>
			<Trigger Property="IsMouseOver" Value="True">
				<Setter Property="Background" Value="{DynamicResource VS.Environment.ScrollBarThumbMouseOverBackgroundBrush}" />
			</Trigger>
			<Trigger Property="IsDragging" Value="True">
				<Setter Property="Background" Value="{DynamicResource VS.Environment.ScrollBarThumbPressedBackgroundBrush}" />
			</Trigger>
		</Style.Triggers>
	</Style>
	<Style x:Key="ScrollBarThumbHorizontal" TargetType="{x:Type Thumb}">
		<Setter Property="OverridesDefaultStyle" Value="true"/>
		<Setter Property="IsTabStop" Value="false"/>
		<Setter Property="BorderBrush" Value="{DynamicResource VS.Environment.ScrollBarBackgroundBrush}" />
		<Setter Property="BorderThickness" Value="0,4,0,4" />
		<Setter Property="Background" Value="{DynamicResource VS.Environment.ScrollBarThumbBackgroundBrush}" />
		<Setter Property="Template">
			<Setter.Value>
				<ControlTemplate TargetType="{x:Type Thumb}">
					<Border x:Name="rectangle" Height="{TemplateBinding Height}" Width="{TemplateBinding Width}" Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" />
				</ControlTemplate>
			</Setter.Value>
		</Setter>
		<Style.Triggers>
			<Trigger Property="IsMouseOver" Value="True">
				<Setter Property="Background" Value="{DynamicResource VS.Environment.ScrollBarThumbMouseOverBackgroundBrush}" />
			</Trigger>
			<Trigger Property="IsDragging" Value="True">
				<Setter Property="Background" Value="{DynamicResource VS.Environment.ScrollBarThumbPressedBackgroundBrush}" />
			</Trigger>
		</Style.Triggers>
	</Style>
	
	<Style x:Key="ScrollBarButton" TargetType="{x:Type RepeatButton}">
		<Setter Property="FocusVisualStyle" Value="{StaticResource FocusVisual}"/>
		<Setter Property="BorderThickness" Value="0"/>
		<Setter Property="HorizontalContentAlignment" Value="Center"/>
		<Setter Property="VerticalContentAlignment" Value="Center"/>
		<Setter Property="Padding" Value="0"/>
		<Setter Property="Focusable" Value="false"/>
		<Setter Property="IsTabStop" Value="false"/>
		<Setter Property="Background" Value="{DynamicResource VS.Environment.ScrollBarBackgroundBrush}" />
		<Setter Property="Template">
			<Setter.Value>
				<ControlTemplate TargetType="{x:Type RepeatButton}">
					<Border x:Name="border" BorderThickness="{TemplateBinding BorderThickness}" SnapsToDevicePixels="true" Background="{TemplateBinding Background}">
						<ContentPresenter x:Name="contentPresenter" Focusable="False" HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" Margin="{TemplateBinding Padding}" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
					</Border>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>

	<Style TargetType="ScrollBar" BasedOn="{StaticResource {x:Type ScrollBar}}">
		<Setter Property="Stylus.IsPressAndHoldEnabled" Value="false"/>
		<Setter Property="Stylus.IsFlicksEnabled" Value="false"/>
		<Setter Property="Background" Value="{DynamicResource VS.Environment.ScrollBarBackgroundBrush}" />
		<Setter Property="BorderBrush" Value="{DynamicResource VS.Environment.ScrollBarBorderBrush}" />
		<Setter Property="BorderThickness" Value="0" />
		<Setter Property="Width" Value="{DynamicResource {x:Static SystemParameters.VerticalScrollBarWidthKey}}"/>
		<Setter Property="MinWidth" Value="{DynamicResource {x:Static SystemParameters.VerticalScrollBarWidthKey}}"/>
		<Setter Property="Template">
			<Setter.Value>
				<ControlTemplate TargetType="{x:Type ScrollBar}">
					<Grid x:Name="Bg" SnapsToDevicePixels="true">
						<Grid.RowDefinitions>
							<RowDefinition MaxHeight="{DynamicResource {x:Static SystemParameters.VerticalScrollBarButtonHeightKey}}"/>
							<RowDefinition Height="0.00001*"/>
							<RowDefinition MaxHeight="{DynamicResource {x:Static SystemParameters.VerticalScrollBarButtonHeightKey}}"/>
						</Grid.RowDefinitions>
						<Border BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Background="{TemplateBinding Background}" Grid.Row="1"/>
						<RepeatButton x:Name="PART_LineUpButton" Grid.Row="0" Command="{x:Static ScrollBar.LineUpCommand}" IsEnabled="{TemplateBinding IsMouseOver}" Style="{StaticResource ScrollBarButton}" Background="{DynamicResource VS.Environment.ScrollBarArrowBackgroundBrush}">
							<Path x:Name="ArrowTop" Data="M0,5L9,5 9,4 8,4 8,3 7,3 7,2 6,2 6,1 5,1 5,0 4,0 4,1 3,1 3,2 2,2 2,3 1,3 1,4 0,4z" Fill="{DynamicResource VS.Environment.ScrollBarArrowGlyphBrush}" Margin="0" Stretch="None"/>
						</RepeatButton>
						<Track x:Name="PART_Track" IsDirectionReversed="true" IsEnabled="{TemplateBinding IsMouseOver}" Grid.Row="1">
							<Track.DecreaseRepeatButton>
								<RepeatButton Command="{x:Static ScrollBar.PageUpCommand}" Style="{StaticResource ScrollBarButton}" Background="{DynamicResource VS.Environment.ScrollBarArrowBackgroundBrush}" />
							</Track.DecreaseRepeatButton>
							<Track.IncreaseRepeatButton>
								<RepeatButton Command="{x:Static ScrollBar.PageDownCommand}" Style="{StaticResource ScrollBarButton}" Background="{DynamicResource VS.Environment.ScrollBarArrowBackgroundBrush}" />
							</Track.IncreaseRepeatButton>
							<Track.Thumb>
								<Thumb Style="{StaticResource ScrollBarThumbVertical}"/>
							</Track.Thumb>
						</Track>
						<RepeatButton x:Name="PART_LineDownButton" Command="{x:Static ScrollBar.LineDownCommand}" IsEnabled="{TemplateBinding IsMouseOver}" Grid.Row="2" Style="{StaticResource ScrollBarButton}">
							<Path x:Name="ArrowBottom" Data="M0,0L9,0 9,1 8,1 8,2 8,2 7,2 7,3 6,3 6,4 5,4 5,5 4,5 4,4 3,4 3,3 2,3 2,2 1,2 1,1 0,1z" Fill="{DynamicResource VS.Environment.ScrollBarArrowGlyphBrush}" Margin="0" Stretch="None"/>
						</RepeatButton>
					</Grid>
					<ControlTemplate.Triggers>
						<MultiDataTrigger>
							<MultiDataTrigger.Conditions>
								<Condition Binding="{Binding IsMouseOver, ElementName=PART_LineDownButton}" Value="true"/>
								<Condition Binding="{Binding IsPressed, ElementName=PART_LineDownButton}" Value="true"/>
							</MultiDataTrigger.Conditions>
							<Setter Property="Fill" TargetName="ArrowBottom" Value="{DynamicResource VS.Environment.ScrollBarThumbPressedBackgroundBrush}"/>
						</MultiDataTrigger>
						<MultiDataTrigger>
							<MultiDataTrigger.Conditions>
								<Condition Binding="{Binding IsMouseOver, ElementName=PART_LineUpButton}" Value="true"/>
								<Condition Binding="{Binding IsPressed, ElementName=PART_LineUpButton}" Value="true"/>
							</MultiDataTrigger.Conditions>
							<Setter Property="Fill" TargetName="ArrowTop" Value="{DynamicResource VS.Environment.ScrollBarThumbPressedBackgroundBrush}"/>
						</MultiDataTrigger>
						<MultiDataTrigger>
							<MultiDataTrigger.Conditions>
								<Condition Binding="{Binding IsMouseOver, ElementName=PART_LineDownButton}" Value="true"/>
								<Condition Binding="{Binding IsPressed, ElementName=PART_LineDownButton}" Value="false"/>
							</MultiDataTrigger.Conditions>
							<Setter Property="Fill" TargetName="ArrowBottom" Value="{DynamicResource VS.Environment.ScrollBarArrowGlyphMouseOverBrush}"/>
						</MultiDataTrigger>
						<MultiDataTrigger>
							<MultiDataTrigger.Conditions>
								<Condition Binding="{Binding IsMouseOver, ElementName=PART_LineUpButton}" Value="true"/>
								<Condition Binding="{Binding IsPressed, ElementName=PART_LineUpButton}" Value="false"/>
							</MultiDataTrigger.Conditions>
							<Setter Property="Fill" TargetName="ArrowTop" Value="{DynamicResource VS.Environment.ScrollBarArrowGlyphMouseOverBrush}"/>
						</MultiDataTrigger>
						<Trigger Property="IsEnabled" Value="false">
							<Setter Property="Fill" TargetName="ArrowTop" Value="{DynamicResource VS.Environment.ScrollBarArrowDisabledBackgroundBrush}"/>
							<Setter Property="Fill" TargetName="ArrowBottom" Value="{DynamicResource VS.Environment.ScrollBarArrowDisabledBackgroundBrush}"/>
						</Trigger>
					</ControlTemplate.Triggers>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
		<Style.Triggers>
			<Trigger Property="Orientation" Value="Horizontal">
				<Setter Property="Width" Value="Auto"/>
				<Setter Property="MinWidth" Value="0"/>
				<Setter Property="Height" Value="{DynamicResource {x:Static SystemParameters.HorizontalScrollBarHeightKey}}"/>
				<Setter Property="MinHeight" Value="{DynamicResource {x:Static SystemParameters.HorizontalScrollBarHeightKey}}"/>
				<Setter Property="BorderThickness" Value="0" />
				<Setter Property="Template">
					<Setter.Value>
						<ControlTemplate TargetType="{x:Type ScrollBar}">
							<Grid x:Name="Bg" SnapsToDevicePixels="true">
								<Grid.ColumnDefinitions>
									<ColumnDefinition MaxWidth="{DynamicResource {x:Static SystemParameters.HorizontalScrollBarButtonWidthKey}}"/>
									<ColumnDefinition Width="0.00001*"/>
									<ColumnDefinition MaxWidth="{DynamicResource {x:Static SystemParameters.HorizontalScrollBarButtonWidthKey}}"/>
								</Grid.ColumnDefinitions>
								<Border BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Background="{TemplateBinding Background}" Grid.Column="1"/>
								<RepeatButton x:Name="PART_LineLeftButton" Grid.Column="0" Command="{x:Static ScrollBar.LineLeftCommand}" IsEnabled="{TemplateBinding IsMouseOver}" Style="{StaticResource ScrollBarButton}">
									<Path x:Name="ArrowLeft" Data="M 3.18,7 C3.18,7 5,7 5,7 5,7 1.81,3.5 1.81,3.5 1.81,3.5 5,0 5,0 5,0 3.18,0 3.18,0 3.18,0 0,3.5 0,3.5 0,3.5 3.18,7 3.18,7 z" Fill="{DynamicResource VS.Environment.ScrollBarArrowGlyphBrush}" Margin="3" Stretch="Uniform"/>
								</RepeatButton>
								<Track x:Name="PART_Track" Grid.Column="1" IsEnabled="{TemplateBinding IsMouseOver}">
									<Track.DecreaseRepeatButton>
										<RepeatButton Command="{x:Static ScrollBar.PageLeftCommand}" Style="{StaticResource RepeatButtonTransparent}"/>
									</Track.DecreaseRepeatButton>
									<Track.IncreaseRepeatButton>
										<RepeatButton Command="{x:Static ScrollBar.PageRightCommand}" Style="{StaticResource RepeatButtonTransparent}"/>
									</Track.IncreaseRepeatButton>
									<Track.Thumb>
										<Thumb Style="{StaticResource ScrollBarThumbHorizontal}"/>
									</Track.Thumb>
								</Track>
								<RepeatButton x:Name="PART_LineRightButton" Grid.Column="2" Command="{x:Static ScrollBar.LineRightCommand}" IsEnabled="{TemplateBinding IsMouseOver}" Style="{StaticResource ScrollBarButton}">
									<Path x:Name="ArrowRight" Data="M 1.81,7 C1.81,7 0,7 0,7 0,7 3.18,3.5 3.18,3.5 3.18,3.5 0,0 0,0 0,0 1.81,0 1.81,0 1.81,0 5,3.5 5,3.5 5,3.5 1.81,7 1.81,7 z" Fill="{DynamicResource VS.Environment.ScrollBarArrowGlyphBrush}" Margin="3" Stretch="Uniform"/>
								</RepeatButton>
							</Grid>
							<ControlTemplate.Triggers>
								<MultiDataTrigger>
									<MultiDataTrigger.Conditions>
										<Condition Binding="{Binding IsMouseOver, ElementName=PART_LineRightButton}" Value="true"/>
										<Condition Binding="{Binding IsPressed, ElementName=PART_LineRightButton}" Value="true"/>
									</MultiDataTrigger.Conditions>
									<Setter Property="Fill" TargetName="ArrowRight" Value="{DynamicResource VS.Environment.ScrollBarThumbPressedBackgroundBrush}"/>
								</MultiDataTrigger>
								<MultiDataTrigger>
									<MultiDataTrigger.Conditions>
										<Condition Binding="{Binding IsMouseOver, ElementName=PART_LineLeftButton}" Value="true"/>
										<Condition Binding="{Binding IsPressed, ElementName=PART_LineLeftButton}" Value="true"/>
									</MultiDataTrigger.Conditions>
									<Setter Property="Fill" TargetName="ArrowLeft" Value="{DynamicResource VS.Environment.ScrollBarThumbPressedBackgroundBrush}"/>
								</MultiDataTrigger>
								<MultiDataTrigger>
									<MultiDataTrigger.Conditions>
										<Condition Binding="{Binding IsMouseOver, ElementName=PART_LineRightButton}" Value="true"/>
										<Condition Binding="{Binding IsPressed, ElementName=PART_LineRightButton}" Value="false"/>
									</MultiDataTrigger.Conditions>
									<Setter Property="Fill" TargetName="ArrowRight" Value="{DynamicResource VS.Environment.ScrollBarArrowGlyphMouseOverBrush}"/>
								</MultiDataTrigger>
								<MultiDataTrigger>
									<MultiDataTrigger.Conditions>
										<Condition Binding="{Binding IsMouseOver, ElementName=PART_LineLeftButton}" Value="true"/>
										<Condition Binding="{Binding IsPressed, ElementName=PART_LineLeftButton}" Value="false"/>
									</MultiDataTrigger.Conditions>
									<Setter Property="Fill" TargetName="ArrowLeft" Value="{DynamicResource VS.Environment.ScrollBarArrowGlyphMouseOverBrush}"/>
								</MultiDataTrigger>
								<Trigger Property="IsEnabled" Value="false">
									<Setter Property="Fill" TargetName="ArrowLeft" Value="Transparent"/>
									<Setter Property="Fill" TargetName="ArrowRight" Value="Transparent"/>
								</Trigger>
							</ControlTemplate.Triggers>
						</ControlTemplate>
					</Setter.Value>
				</Setter>
			</Trigger>
		</Style.Triggers>
	</Style>

	<Style TargetType="{x:Type ScrollViewer}">
		<Setter Property="Template">
			<Setter.Value>
				<ControlTemplate TargetType="{x:Type ScrollViewer}">
					<Grid x:Name="Grid" Background="{TemplateBinding Background}">
						<Grid.ColumnDefinitions>
							<ColumnDefinition Width="*"/>
							<ColumnDefinition Width="Auto"/>
						</Grid.ColumnDefinitions>
						<Grid.RowDefinitions>
							<RowDefinition Height="*"/>
							<RowDefinition Height="Auto"/>
						</Grid.RowDefinitions>
						<Rectangle x:Name="Corner" Grid.Column="1" Fill="{TemplateBinding Background}" Grid.Row="1"/>
						<ScrollContentPresenter x:Name="PART_ScrollContentPresenter" CanContentScroll="{TemplateBinding CanContentScroll}" CanHorizontallyScroll="False" CanVerticallyScroll="False" ContentTemplate="{TemplateBinding ContentTemplate}" Content="{TemplateBinding Content}" Grid.Column="0" Margin="{TemplateBinding Padding}" Grid.Row="0"/>
						<ScrollBar x:Name="PART_VerticalScrollBar" AutomationProperties.AutomationId="VerticalScrollBar" Cursor="Arrow" Grid.Column="1" Maximum="{TemplateBinding ScrollableHeight}" Minimum="0" Grid.Row="0" Visibility="{TemplateBinding ComputedVerticalScrollBarVisibility}" Value="{Binding VerticalOffset, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}" ViewportSize="{TemplateBinding ViewportHeight}"/>
						<ScrollBar x:Name="PART_HorizontalScrollBar" AutomationProperties.AutomationId="HorizontalScrollBar" Cursor="Arrow" Grid.Column="0" Maximum="{TemplateBinding ScrollableWidth}" Minimum="0" Orientation="Horizontal" Grid.Row="1" Visibility="{TemplateBinding ComputedHorizontalScrollBarVisibility}" Value="{Binding HorizontalOffset, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}" ViewportSize="{TemplateBinding ViewportWidth}"/>
					</Grid>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>

	<Style x:Key="EmptyCheckBoxFocusVisualSquare" TargetType="Control" BasedOn="{StaticResource GenericVisualFocusStyle}">
		<Setter Property="Margin" Value="-3,0,0,0" />
		<Setter Property="Width" Value="22" />
		<Setter Property="Height" Value="21" />
		<Setter Property="HorizontalAlignment" Value="Left" />
		<Setter Property="VerticalAlignment" Value="Center" />
	</Style>

	<Style TargetType="CheckBox" BasedOn="{StaticResource {x:Type CheckBox}}">
		<Setter Property="FocusVisualStyle" Value="{StaticResource EmptyCheckBoxFocusVisualSquare}" />
	</Style>

	<Style TargetType="{x:Type ComboBoxItem}">
		<Setter Property="SnapsToDevicePixels" Value="True"/>
		<Setter Property="Padding" Value="4,1"/>
		<Setter Property="HorizontalContentAlignment" Value="{Binding HorizontalContentAlignment, RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}"/>
		<Setter Property="VerticalContentAlignment" Value="{Binding VerticalContentAlignment, RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}"/>
		<Setter Property="Background" Value="Transparent"/>
		<Setter Property="BorderBrush" Value="Transparent"/>
		<Setter Property="BorderThickness" Value="1"/>
		<Setter Property="FocusVisualStyle" Value="{StaticResource GenericVisualFocusStyle}"/>
		<Setter Property="Foreground" Value="{DynamicResource ListItemForegroundBrush}" />
		<Setter Property="Template">
			<Setter.Value>
				<ControlTemplate TargetType="{x:Type ComboBoxItem}">
					<Border x:Name="Bd" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Background="{TemplateBinding Background}" Padding="{TemplateBinding Padding}" SnapsToDevicePixels="true">
						<ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
					</Border>
					<ControlTemplate.Triggers>
						<Trigger Property="IsEnabled" Value="False">
							<Setter Property="TextElement.Foreground" TargetName="Bd" Value="{DynamicResource ListItemDisabledForegroundBrush}"/>
						</Trigger>
						<Trigger Property="IsHighlighted" Value="True">
							<Setter Property="Background" TargetName="Bd" Value="{DynamicResource ListItemHighlightBackgroundBrush}"/>
							<Setter Property="BorderBrush" TargetName="Bd" Value="{DynamicResource ListItemHighlightBorderBrush}"/>
						</Trigger>
					</ControlTemplate.Triggers>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>

	<Style x:Key="ComboBoxToggleButton" TargetType="{x:Type local:ToggleButtonEx}">
		<Setter Property="OverridesDefaultStyle" Value="true"/>
		<Setter Property="IsTabStop" Value="false"/>
		<Setter Property="Focusable" Value="false"/>
		<Setter Property="ClickMode" Value="Press"/>
		<Setter Property="Template">
			<Setter.Value>
				<ControlTemplate TargetType="{x:Type local:ToggleButtonEx}">
					<Border x:Name="templateRoot" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Background="{TemplateBinding Background}" SnapsToDevicePixels="true">
						<Border x:Name="splitBorder" BorderBrush="{DynamicResource ComboBoxButtonSeparatorBrush}" BorderThickness="1,0,0,0" HorizontalAlignment="Right" Margin="0" SnapsToDevicePixels="true" Width="12">
							<Path x:Name="arrow" Data="F1 M 0,0 L 2.667,2.66665 L 5.3334,0 L 5.3334,-1.78168 L 2.6667,0.88501 L0,-1.78168 L0,0 Z" Fill="{TemplateBinding Foreground}" HorizontalAlignment="Center" Margin="0" VerticalAlignment="Center"/>
						</Border>
					</Border>
					<ControlTemplate.Triggers>
						<Trigger Property="IsMouseOver" Value="True">
							<Setter Property="IsMouseOverRemote" Value="True" />
						</Trigger>
						<MultiDataTrigger>
							<MultiDataTrigger.Conditions>
								<Condition Binding="{Binding IsEditable, RelativeSource={RelativeSource AncestorType={x:Type ComboBox}}}" Value="true"/>
								<Condition Binding="{Binding IsMouseOverRemote, RelativeSource={RelativeSource Self}}" Value="false"/>
								<Condition Binding="{Binding IsPressed, RelativeSource={RelativeSource Self}}" Value="false"/>
								<Condition Binding="{Binding IsEnabled, RelativeSource={RelativeSource Self}}" Value="true"/>
							</MultiDataTrigger.Conditions>
							<Setter Property="Background" TargetName="templateRoot" Value="{DynamicResource ComboBoxBackgroundBrush}"/>
							<Setter Property="BorderBrush" TargetName="templateRoot" Value="{DynamicResource ComboBoxBorderBrush}"/>
							<Setter Property="BorderBrush" TargetName="splitBorder" Value="{DynamicResource ComboBoxButtonSeparatorBrush}" />
							<Setter Property="Background" TargetName="splitBorder" Value="{DynamicResource ComboBoxButtonBackgroundBrush}" />
						</MultiDataTrigger>
						<MultiDataTrigger>
							<MultiDataTrigger.Conditions>
								<Condition Binding="{Binding IsMouseOverRemote, RelativeSource={RelativeSource Self}}" Value="true"/>
								<Condition Binding="{Binding IsEditable, RelativeSource={RelativeSource AncestorType={x:Type ComboBox}}}" Value="false"/>
							</MultiDataTrigger.Conditions>
							<Setter Property="Background" TargetName="templateRoot" Value="{DynamicResource ComboBoxMouseOverBackgroundBrush}"/>
							<Setter Property="BorderBrush" TargetName="templateRoot" Value="{DynamicResource ComboBoxMouseOverBorderBrush}"/>
							<Setter Property="BorderBrush" TargetName="splitBorder" Value="{DynamicResource ComboBoxButtonMouseOverSeparatorBrush}" />
							<Setter Property="Background" TargetName="splitBorder" Value="{DynamicResource ComboBoxButtonMouseOverBackgroundBrush}" />
						</MultiDataTrigger>
						<MultiDataTrigger>
							<MultiDataTrigger.Conditions>
								<Condition Binding="{Binding IsMouseOverRemote, RelativeSource={RelativeSource Self}}" Value="true"/>
								<Condition Binding="{Binding IsEditable, RelativeSource={RelativeSource AncestorType={x:Type ComboBox}}}" Value="true"/>
							</MultiDataTrigger.Conditions>
							<Setter Property="Background" TargetName="templateRoot" Value="{DynamicResource ComboBoxMouseOverBackgroundBrush}"/>
							<Setter Property="BorderBrush" TargetName="templateRoot" Value="{DynamicResource ComboBoxMouseOverBorderBrush}"/>
							<Setter Property="BorderBrush" TargetName="splitBorder" Value="{DynamicResource ComboBoxButtonSeparatorBrush}" />
							<Setter Property="Background" TargetName="splitBorder" Value="{DynamicResource ComboBoxButtonBackgroundBrush}" />
						</MultiDataTrigger>
						<MultiDataTrigger>
							<MultiDataTrigger.Conditions>
								<Condition Binding="{Binding IsPressed, RelativeSource={RelativeSource Self}}" Value="true"/>
								<Condition Binding="{Binding IsEditable, RelativeSource={RelativeSource AncestorType={x:Type ComboBox}}}" Value="false"/>
							</MultiDataTrigger.Conditions>
							<Setter Property="Background" TargetName="templateRoot" Value="{DynamicResource ComboBoxPressedBackgroundBrush}"/>
							<Setter Property="BorderBrush" TargetName="templateRoot" Value="{DynamicResource ComboBoxPressedBorderBrush}"/>
							<Setter Property="BorderBrush" TargetName="splitBorder" Value="{DynamicResource ComboBoxButtonPressedSeparatorBrush}" />
							<Setter Property="Background" TargetName="splitBorder" Value="{DynamicResource ComboBoxButtonPressedSeparatorBrush}" />
						</MultiDataTrigger>
						<MultiDataTrigger>
							<MultiDataTrigger.Conditions>
								<Condition Binding="{Binding IsPressed, RelativeSource={RelativeSource Self}}" Value="true"/>
								<Condition Binding="{Binding IsEditable, RelativeSource={RelativeSource AncestorType={x:Type ComboBox}}}" Value="true"/>
							</MultiDataTrigger.Conditions>
							<Setter Property="Background" TargetName="templateRoot" Value="{DynamicResource ComboBoxPressedBackgroundBrush}"/>
							<Setter Property="BorderBrush" TargetName="templateRoot" Value="{DynamicResource ComboBoxPressedBorderBrush}"/>
							<Setter Property="BorderBrush" TargetName="splitBorder" Value="{DynamicResource ComboBoxButtonPressedSeparatorBrush}" />
							<Setter Property="Background" TargetName="splitBorder" Value="{DynamicResource ComboBoxButtonPressedSeparatorBrush}" />
						</MultiDataTrigger>
						<MultiDataTrigger>
							<MultiDataTrigger.Conditions>
								<Condition Binding="{Binding IsMouseOver, ElementName=splitBorder}" Value="true" />
								<Condition Binding="{Binding IsEditable, RelativeSource={RelativeSource AncestorType={x:Type ComboBox}}}" Value="true"/>
							</MultiDataTrigger.Conditions>
							<Setter Property="BorderBrush" TargetName="splitBorder" Value="{DynamicResource ComboBoxButtonMouseOverSeparatorBrush}" />
							<Setter Property="Background" TargetName="splitBorder" Value="{DynamicResource ComboBoxButtonMouseOverBackgroundBrush}" />
						</MultiDataTrigger>
					</ControlTemplate.Triggers>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>
	
	<ControlTemplate x:Key="ComboBoxTemplate" TargetType="{x:Type ComboBox}">
		<Grid x:Name="templateRoot" SnapsToDevicePixels="true">
			<Grid.ColumnDefinitions>
				<ColumnDefinition Width="*"/>
				<ColumnDefinition MinWidth="{DynamicResource {x:Static SystemParameters.VerticalScrollBarWidthKey}}" Width="0"/>
			</Grid.ColumnDefinitions>
			<Popup x:Name="PART_Popup" AllowsTransparency="true" Grid.ColumnSpan="2" IsOpen="{Binding IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}" Margin="1" Placement="Bottom">
				<theme:SystemDropShadowChrome x:Name="shadow" Color="Transparent" MaxHeight="{TemplateBinding MaxDropDownHeight}" MinWidth="{Binding ActualWidth, ElementName=templateRoot}">
					<Border x:Name="dropDownBorder" BorderBrush="{DynamicResource ComboBoxPopupBorderBrush}" BorderThickness="1" Background="{DynamicResource ComboBoxPopupBackgroundBrush}">
						<ScrollViewer x:Name="DropDownScrollViewer">
							<Grid x:Name="grid" RenderOptions.ClearTypeHint="Enabled">
								<Canvas x:Name="canvas" HorizontalAlignment="Left" Height="0" VerticalAlignment="Top" Width="0">
									<Rectangle x:Name="opaqueRect" Fill="{Binding Background, ElementName=dropDownBorder}" Height="{Binding ActualHeight, ElementName=dropDownBorder}" Width="{Binding ActualWidth, ElementName=dropDownBorder}"/>
								</Canvas>
								<ItemsPresenter x:Name="ItemsPresenter" KeyboardNavigation.DirectionalNavigation="Contained" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
							</Grid>
						</ScrollViewer>
					</Border>
				</theme:SystemDropShadowChrome>
			</Popup>
			<local:ToggleButtonEx x:Name="toggleButton" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Background="{TemplateBinding Background}" Grid.ColumnSpan="2" IsChecked="{Binding IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}" Style="{StaticResource ComboBoxToggleButton}"/>
			<ContentPresenter x:Name="contentPresenter" ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}" ContentTemplateSelector="{TemplateBinding ItemTemplateSelector}" Content="{TemplateBinding SelectionBoxItem}" ContentStringFormat="{TemplateBinding SelectionBoxItemStringFormat}" HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" IsHitTestVisible="false" Margin="{TemplateBinding Padding}" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
		</Grid>
		<ControlTemplate.Triggers>
			<Trigger Property="HasDropShadow" SourceName="PART_Popup" Value="true">
				<Setter Property="Margin" TargetName="shadow" Value="0,0,5,5"/>
				<Setter Property="Color" TargetName="shadow" Value="#71000000"/>
			</Trigger>
			<Trigger Property="HasItems" Value="false">
				<Setter Property="Height" TargetName="dropDownBorder" Value="95"/>
			</Trigger>
			<MultiTrigger>
				<MultiTrigger.Conditions>
					<Condition Property="IsGrouping" Value="true"/>
					<Condition Property="VirtualizingPanel.IsVirtualizingWhenGrouping" Value="false"/>
				</MultiTrigger.Conditions>
				<Setter Property="ScrollViewer.CanContentScroll" Value="false"/>
			</MultiTrigger>
			<Trigger Property="ScrollViewer.CanContentScroll" SourceName="DropDownScrollViewer" Value="false">
				<Setter Property="Canvas.Top" TargetName="opaqueRect" Value="{Binding VerticalOffset, ElementName=DropDownScrollViewer}"/>
				<Setter Property="Canvas.Left" TargetName="opaqueRect" Value="{Binding HorizontalOffset, ElementName=DropDownScrollViewer}"/>
			</Trigger>
		</ControlTemplate.Triggers>
	</ControlTemplate>
	
	<Style x:Key="ComboBoxEditableTextBox" TargetType="{x:Type TextBox}">
		<Setter Property="OverridesDefaultStyle" Value="true"/>
		<Setter Property="AllowDrop" Value="true"/>
		<Setter Property="MinWidth" Value="0"/>
		<Setter Property="MinHeight" Value="0"/>
		<Setter Property="CaretBrush" Value="{DynamicResource ComboBoxForegroundBrush}" />
		<Setter Property="FocusVisualStyle" Value="{x:Null}"/>
		<Setter Property="ScrollViewer.PanningMode" Value="VerticalFirst"/>
		<Setter Property="Stylus.IsFlicksEnabled" Value="False"/>
		<Setter Property="Template">
			<Setter.Value>
				<ControlTemplate TargetType="{x:Type TextBox}">
					<ScrollViewer x:Name="PART_ContentHost" Background="Transparent" Focusable="false" HorizontalScrollBarVisibility="Hidden" VerticalScrollBarVisibility="Hidden"/>
				</ControlTemplate>
			</Setter.Value>
		</Setter>
	</Style>
	
	<ControlTemplate x:Key="ComboBoxEditableTemplate" TargetType="{x:Type ComboBox}">
		<Grid x:Name="templateRoot" SnapsToDevicePixels="true">
			<Grid.ColumnDefinitions>
				<ColumnDefinition Width="*"/>
				<ColumnDefinition MinWidth="{DynamicResource {x:Static SystemParameters.VerticalScrollBarWidthKey}}" Width="0"/>
			</Grid.ColumnDefinitions>
			<Popup x:Name="PART_Popup" AllowsTransparency="true" Grid.ColumnSpan="2" IsOpen="{Binding IsDropDownOpen, RelativeSource={RelativeSource TemplatedParent}}" Placement="Bottom">
				<theme:SystemDropShadowChrome x:Name="shadow" Color="Transparent" MaxHeight="{TemplateBinding MaxDropDownHeight}" MinWidth="{Binding ActualWidth, ElementName=templateRoot}">
					<Border x:Name="dropDownBorder" BorderBrush="{DynamicResource ComboBoxPopupBorderBrush}" BorderThickness="1" Background="{DynamicResource ComboBoxPopupBackgroundBrush}">
						<ScrollViewer x:Name="DropDownScrollViewer">
							<Grid x:Name="grid" RenderOptions.ClearTypeHint="Enabled">
								<Canvas x:Name="canvas" HorizontalAlignment="Left" Height="0" VerticalAlignment="Top" Width="0">
									<Rectangle x:Name="opaqueRect" Fill="{Binding Background, ElementName=dropDownBorder}" Height="{Binding ActualHeight, ElementName=dropDownBorder}" Width="{Binding ActualWidth, ElementName=dropDownBorder}"/>
								</Canvas>
								<ItemsPresenter x:Name="ItemsPresenter" KeyboardNavigation.DirectionalNavigation="Contained" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
							</Grid>
						</ScrollViewer>
					</Border>
				</theme:SystemDropShadowChrome>
			</Popup>
			<local:ToggleButtonEx x:Name="toggleButton" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Background="{TemplateBinding Background}" Grid.ColumnSpan="2" IsChecked="{Binding IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}" Style="{StaticResource ComboBoxToggleButton}"/>
			<Border x:Name="border" Margin="{TemplateBinding BorderThickness}">
				<TextBox x:Name="PART_EditableTextBox" HorizontalContentAlignment="{TemplateBinding HorizontalContentAlignment}" IsReadOnly="{Binding IsReadOnly, RelativeSource={RelativeSource TemplatedParent}}" Margin="{TemplateBinding Padding}" Style="{StaticResource ComboBoxEditableTextBox}" VerticalContentAlignment="{TemplateBinding VerticalContentAlignment}"/>
			</Border>
		</Grid>
		<ControlTemplate.Triggers>
			<Trigger Property="IsEnabled" Value="false">
				<Setter Property="Opacity" TargetName="border" Value="0.56"/>
			</Trigger>
			<Trigger Property="IsMouseOver" Value="True">
				<Setter TargetName="toggleButton" Property="IsMouseOverRemote" Value="True" />
			</Trigger>
			<Trigger Property="HasDropShadow" SourceName="PART_Popup" Value="true">
				<Setter Property="Margin" TargetName="shadow" Value="0,0,5,5"/>
				<Setter Property="Color" TargetName="shadow" Value="#71000000"/>
			</Trigger>
			<Trigger Property="HasItems" Value="false">
				<Setter Property="Height" TargetName="dropDownBorder" Value="95"/>
			</Trigger>
			<MultiTrigger>
				<MultiTrigger.Conditions>
					<Condition Property="IsGrouping" Value="true"/>
					<Condition Property="VirtualizingPanel.IsVirtualizingWhenGrouping" Value="false"/>
				</MultiTrigger.Conditions>
				<Setter Property="ScrollViewer.CanContentScroll" Value="false"/>
			</MultiTrigger>
			<Trigger Property="ScrollViewer.CanContentScroll" SourceName="DropDownScrollViewer" Value="false">
				<Setter Property="Canvas.Top" TargetName="opaqueRect" Value="{Binding VerticalOffset, ElementName=DropDownScrollViewer}"/>
				<Setter Property="Canvas.Left" TargetName="opaqueRect" Value="{Binding HorizontalOffset, ElementName=DropDownScrollViewer}"/>
			</Trigger>
		</ControlTemplate.Triggers>
	</ControlTemplate>
	
	<Style TargetType="{x:Type ComboBox}">
		<Setter Property="FocusVisualStyle" Value="{StaticResource GenericVisualFocusStyle}"/>
		<Setter Property="Background" Value="{DynamicResource ComboBoxBackgroundBrush}"/>
		<Setter Property="BorderBrush" Value="{DynamicResource ComboBoxBorderBrush}"/>
		<Setter Property="Foreground" Value="{DynamicResource ComboBoxForegroundBrush}"/>
		<Setter Property="BorderThickness" Value="1"/>
		<Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Auto"/>
		<Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Auto"/>
		<Setter Property="Padding" Value="6,3,5,3"/>
		<Setter Property="ScrollViewer.CanContentScroll" Value="true"/>
		<Setter Property="ScrollViewer.PanningMode" Value="Both"/>
		<Setter Property="Stylus.IsFlicksEnabled" Value="False"/>
		<Setter Property="Template" Value="{StaticResource ComboBoxTemplate}"/>
		<Style.Triggers>
			<Trigger Property="IsEditable" Value="true">
				<Setter Property="IsTabStop" Value="false"/>
				<Setter Property="Padding" Value="2"/>
				<Setter Property="Template" Value="{StaticResource ComboBoxEditableTemplate}"/>
			</Trigger>
		</Style.Triggers>
	</Style>
</ResourceDictionary>
